<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Tensors | A Minimal rTorch Book</title>
<meta name="author" content="Alfonso R. Reyes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.5.3/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.16/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Minimal rTorch Book</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prerequisites</a></li>
<li class="book-part">Getting Started</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="pytorch-and-numpy.html"><span class="header-section-number">2</span> PyTorch and NumPy</a></li>
<li><a class="" href="rtorch-vs-pytorch.html"><span class="header-section-number">3</span> rTorch vs PyTorch</a></li>
<li><a class="" href="converting-tensors.html"><span class="header-section-number">4</span> Converting tensors</a></li>
<li class="book-part">Basic Tensor Operations</li>
<li><a class="active" href="tensors.html"><span class="header-section-number">5</span> Tensors</a></li>
<li><a class="" href="linearalgebra.html"><span class="header-section-number">6</span> Linear Algebra with Torch</a></li>
<li><a class="" href="creating-pytorch-classes.html"><span class="header-section-number">7</span> Creating PyTorch classes</a></li>
<li class="book-part">Logistic Regression</li>
<li><a class="" href="example-1-a-classification-problem.html"><span class="header-section-number">8</span> Example 1: A classification problem</a></li>
<li><a class="" href="mnistdigits.html"><span class="header-section-number">9</span> Example 2: MNIST handwritten digits</a></li>
<li class="book-part">Linear Regression</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">10</span> Linear Regression</a></li>
<li><a class="" href="linear-regression-1.html"><span class="header-section-number">11</span> Linear Regression</a></li>
<li class="book-part">Neural Networks</li>
<li><a class="" href="neural-networks.html"><span class="header-section-number">12</span> Neural Networks</a></li>
<li><a class="" href="a-neural-network-step-by-step.html"><span class="header-section-number">13</span> A neural network step-by-step</a></li>
<li class="book-part">PyTorch and R data structures</li>
<li><a class="" href="working-with-a-dataframe.html"><span class="header-section-number">14</span> Working with a data●frame</a></li>
<li><a class="" href="working-with-datatable.html"><span class="header-section-number">15</span> Working with data●table</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="appendixA.html"><span class="header-section-number">A</span> Statistical Background</a></li>
<li><a class="" href="appendixB.html"><span class="header-section-number">B</span> Activation Functions</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/f0nzie/rtorch-minimal-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="tensors" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Tensors<a class="anchor" aria-label="anchor" href="#tensors"><i class="fas fa-link"></i></a>
</h1>
<p><em>Last update: Sun Oct 25 13:00:41 2020 -0500 (265c0b3c1)</em></p>
<p>In this chapter, we describe the most important PyTorch methods.</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/f0nzie/rTorch">rTorch</a></span><span class="op">)</span></code></pre></div>
<div id="tensor-data-types" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Tensor data types<a class="anchor" aria-label="anchor" href="#tensor-data-types"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Default data type</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">dtype</span>  <span class="co"># default for floating point is torch.float32</span></code></pre></div>
<pre><code>#&gt; torch.float32</code></pre>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># change default data type to float64</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">set_default_dtype</span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="va">float64</span><span class="op">)</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">dtype</span>         <span class="co"># a new floating point tensor</span></code></pre></div>
<pre><code>#&gt; torch.float64</code></pre>
<div id="major-tensor-types" class="section level3" number="5.1.1">
<h3>
<span class="header-section-number">5.1.1</span> Major tensor types<a class="anchor" aria-label="anchor" href="#major-tensor-types"><i class="fas fa-link"></i></a>
</h3>
<p>There are five major type of tensors in PyTorch: byte, float, double, long, and boolean.</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/f0nzie/rTorch">rTorch</a></span><span class="op">)</span>

<span class="va">byte</span>    <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ByteTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span>
<span class="va">float</span>   <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span>
<span class="va">double</span>  <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">DoubleTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span>
<span class="va">long</span>    <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">LongTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span>
<span class="va">boolean</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">BoolTensor</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">5L</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"byte tensor"</span><span class="op">)</span>
<span class="co">#&gt; byte tensor</span>
<span class="va">byte</span>
<span class="co">#&gt; tensor([[ 32,  61, 207],</span>
<span class="co">#&gt;         [238, 114, 127],</span>
<span class="co">#&gt;         [  0,   0,  32]], dtype=torch.uint8)</span></code></pre></div>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"float tensor"</span><span class="op">)</span>
<span class="co">#&gt; float tensor</span>
<span class="va">float</span>
<span class="co">#&gt; tensor([[0., 0., 0.],</span>
<span class="co">#&gt;         [0., 0., 0.],</span>
<span class="co">#&gt;         [0., 0., 0.]], dtype=torch.float32)</span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"double"</span><span class="op">)</span>
<span class="co">#&gt; double</span>
<span class="va">double</span>
<span class="co">#&gt; tensor([[ 0.0000e+00,  0.0000e+00, 9.5490e-313],</span>
<span class="co">#&gt;         [4.6782e-310, 4.9407e-324, 4.6782e-310],</span>
<span class="co">#&gt;         [ 0.0000e+00,  0.0000e+00,  0.0000e+00]])</span></code></pre></div>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"long"</span><span class="op">)</span>
<span class="co">#&gt; long</span>
<span class="va">long</span>
<span class="co">#&gt; tensor([[             1, 94687710309152,              0],</span>
<span class="co">#&gt;         [             0,              0,              0],</span>
<span class="co">#&gt;         [             0,              0,              0]])</span></code></pre></div>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"boolean"</span><span class="op">)</span>
<span class="co">#&gt; boolean</span>
<span class="va">boolean</span>
<span class="co">#&gt; tensor([[False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False,  True]])</span></code></pre></div>
</div>
<div id="example-a-4d-tensor" class="section level3" number="5.1.2">
<h3>
<span class="header-section-number">5.1.2</span> Example: A 4D tensor<a class="anchor" aria-label="anchor" href="#example-a-4d-tensor"><i class="fas fa-link"></i></a>
</h3>
<p>A 4D tensor like in MNIST hand-written digits recognition dataset:</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mnist_4d</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">60000L</span>, <span class="fl">3L</span>, <span class="fl">28L</span>, <span class="fl">28L</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"size"</span><span class="op">)</span>
<span class="co">#&gt; size</span>
<span class="va">mnist_4d</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([60000, 3, 28, 28])</span>

<span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"length"</span><span class="op">)</span>
<span class="co">#&gt; length</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mnist_4d</span><span class="op">)</span>
<span class="co">#&gt; [1] 141120000</span>

<span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"shape, like in numpy"</span><span class="op">)</span>
<span class="co">#&gt; shape, like in numpy</span>
<span class="va">mnist_4d</span><span class="op">$</span><span class="va">shape</span>
<span class="co">#&gt; torch.Size([60000, 3, 28, 28])</span>

<span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"number of elements"</span><span class="op">)</span>
<span class="co">#&gt; number of elements</span>
<span class="va">mnist_4d</span><span class="op">$</span><span class="fu">numel</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] 141120000</span></code></pre></div>
</div>
<div id="example-a-3d-tensor" class="section level3" number="5.1.3">
<h3>
<span class="header-section-number">5.1.3</span> Example: A 3D tensor<a class="anchor" aria-label="anchor" href="#example-a-3d-tensor"><i class="fas fa-link"></i></a>
</h3>
<p>Given a 3D tensor:</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ft3d</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">3L</span>, <span class="fl">2L</span><span class="op">)</span>
<span class="va">ft3d</span></code></pre></div>
<pre><code>#&gt; tensor([[[-3.2069e+28,  4.5719e-41],
#&gt;          [ 4.4665e-11,  3.0893e-41],
#&gt;          [ 1.4668e-10,  3.0893e-41]],
#&gt; 
#&gt;         [[-4.2374e+28,  4.5719e-41],
#&gt;          [ 5.6052e-44,  0.0000e+00],
#&gt;          [ 0.0000e+00,  0.0000e+00]],
#&gt; 
#&gt;         [[ 1.4013e-45,  2.8026e-45],
#&gt;          [ 4.2039e-45,  5.6052e-45],
#&gt;          [ 7.0065e-45,  8.4078e-45]],
#&gt; 
#&gt;         [[ 9.8091e-45,  1.1210e-44],
#&gt;          [ 1.2612e-44,  1.4013e-44],
#&gt;          [ 1.5414e-44,  1.6816e-44]]], dtype=torch.float32)</code></pre>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ft3d</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([4, 3, 2])</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ft3d</span><span class="op">)</span>
<span class="co">#&gt; [1] 24</span>
<span class="va">ft3d</span><span class="op">$</span><span class="va">shape</span>
<span class="co">#&gt; torch.Size([4, 3, 2])</span>
<span class="va">ft3d</span><span class="op">$</span><span class="va">numel</span>
<span class="co">#&gt; &lt;built-in method numel of Tensor&gt;</span></code></pre></div>
</div>
</div>
<div id="arithmetic-of-tensors" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Arithmetic of tensors<a class="anchor" aria-label="anchor" href="#arithmetic-of-tensors"><i class="fas fa-link"></i></a>
</h2>
<div id="add-tensors" class="section level3" number="5.2.1">
<h3>
<span class="header-section-number">5.2.1</span> Add tensors<a class="anchor" aria-label="anchor" href="#add-tensors"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># add a scalar to a tensor</span>
<span class="co"># 3x5 matrix uniformly distributed between 0 and 1</span>
<span class="va">mat0</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">$</span><span class="fu">uniform_</span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">1L</span><span class="op">)</span>
<span class="va">mat0</span> <span class="op">+</span> <span class="fl">0.1</span></code></pre></div>
<pre><code>#&gt; tensor([[0.3650, 0.7111, 0.5408, 0.3499, 0.6317],
#&gt;         [0.4526, 1.0476, 0.4710, 0.2819, 1.0654],
#&gt;         [1.0387, 0.8991, 0.8999, 1.0869, 0.3825]], dtype=torch.float32)</code></pre>
</div>
<div id="add-tensor-elements" class="section level3" number="5.2.2">
<h3>
<span class="header-section-number">5.2.2</span> Add tensor elements<a class="anchor" aria-label="anchor" href="#add-tensor-elements"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># fill a 3x5 matrix with 0.1</span>
<span class="va">mat1</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">$</span><span class="fu">uniform_</span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span>
<span class="co">#&gt; tensor([[0.1000, 0.1000, 0.1000, 0.1000, 0.1000],</span>
<span class="co">#&gt;         [0.1000, 0.1000, 0.1000, 0.1000, 0.1000],</span>
<span class="co">#&gt;         [0.1000, 0.1000, 0.1000, 0.1000, 0.1000]], dtype=torch.float32)</span>

<span class="co"># a vector with all ones</span>
<span class="va">mat2</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">5L</span><span class="op">)</span><span class="op">$</span><span class="fu">uniform_</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mat2</span><span class="op">)</span>
<span class="co">#&gt; tensor([1., 1., 1., 1., 1.], dtype=torch.float32)</span>

<span class="co"># add element (1,1) to another tensor</span>
<span class="va">mat1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">mat2</span>
<span class="co">#&gt; tensor([1.1000, 1.1000, 1.1000, 1.1000, 1.1000], dtype=torch.float32)</span></code></pre></div>
<p>Add two tensors using the function <code>add()</code>:</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># PyTorch add two tensors</span>
<span class="va">x</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">rand</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">4L</span><span class="op">)</span>
<span class="va">y</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">rand</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">4L</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[0.7098, 1.0429, 0.7067, 0.3477],
#&gt;         [1.4853, 1.2497, 0.6409, 1.7089],
#&gt;         [0.8443, 1.4717, 1.3448, 1.0267],
#&gt;         [1.4407, 1.0881, 0.2117, 1.3567],
#&gt;         [0.6607, 1.0855, 0.8206, 0.8289]])</code></pre>
<p>Add two tensors using the generic <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>:</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[0.7098, 1.0429, 0.7067, 0.3477],
#&gt;         [1.4853, 1.2497, 0.6409, 1.7089],
#&gt;         [0.8443, 1.4717, 1.3448, 1.0267],
#&gt;         [1.4407, 1.0881, 0.2117, 1.3567],
#&gt;         [0.6607, 1.0855, 0.8206, 0.8289]])</code></pre>
</div>
<div id="multiply-a-tensor-by-a-scalar" class="section level3" number="5.2.3">
<h3>
<span class="header-section-number">5.2.3</span> Multiply a tensor by a scalar<a class="anchor" aria-label="anchor" href="#multiply-a-tensor-by-a-scalar"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Multiply tensor by scalar</span>
<span class="va">tensor</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">4L</span>, dtype<span class="op">=</span><span class="va">torch</span><span class="op">$</span><span class="va">float64</span><span class="op">)</span>
<span class="va">scalar</span> <span class="op">=</span> <span class="va">np</span><span class="op">$</span><span class="fu">float64</span><span class="op">(</span><span class="fl">4.321</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">scalar</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">scalar_tensor</span><span class="op">(</span><span class="va">scalar</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; [1] 4.32
#&gt; tensor(4.3210)</code></pre>
<blockquote>
<p>Notice that we used a NumPy function to create the scalar object <code>np$float64()</code>.</p>
</blockquote>
<p>Multiply two tensors using the function <code>mul</code>:</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">prod</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">mul</span><span class="op">(</span><span class="va">tensor</span>, <span class="va">torch</span><span class="op">$</span><span class="fu">scalar_tensor</span><span class="op">(</span><span class="va">scalar</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([4.3210, 4.3210, 4.3210, 4.3210])</code></pre>
<p>Short version using R generics:</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">prod</span> <span class="op">=</span> <span class="va">tensor</span> <span class="op">*</span> <span class="va">scalar</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([4.3210, 4.3210, 4.3210, 4.3210])</code></pre>
</div>
</div>
<div id="numpy-and-pytorch" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> NumPy and PyTorch<a class="anchor" aria-label="anchor" href="#numpy-and-pytorch"><i class="fas fa-link"></i></a>
</h2>
<p><code>numpy</code> has been made available as a module in <code>rTorch</code>, which means that as soon as rTorch is loaded, you also get all the <code>numpy</code> functions available to you. We can call functions from <code>numpy</code> referring to it as <code>np$_a_function</code>. Examples:</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># a 2D numpy array  </span>
<span class="va">syn0</span> <span class="op">&lt;-</span> <span class="va">np</span><span class="op">$</span><span class="va">random</span><span class="op">$</span><span class="fu">rand</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">syn0</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt;       [,1]  [,2]   [,3]  [,4]   [,5]
#&gt; [1,] 0.120 0.304 0.7796 0.303 0.7737
#&gt; [2,] 0.197 0.893 0.0919 0.455 0.0865
#&gt; [3,] 0.606 0.979 0.1491 0.896 0.3152</code></pre>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># numpy arrays of zeros</span>
<span class="va">syn1</span> <span class="op">&lt;-</span> <span class="va">np</span><span class="op">$</span><span class="fu">zeros</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">10L</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">syn1</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
#&gt; [1,]    0    0    0    0    0    0    0    0    0     0
#&gt; [2,]    0    0    0    0    0    0    0    0    0     0
#&gt; [3,]    0    0    0    0    0    0    0    0    0     0
#&gt; [4,]    0    0    0    0    0    0    0    0    0     0
#&gt; [5,]    0    0    0    0    0    0    0    0    0     0</code></pre>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># add a scalar to a numpy array</span>
<span class="va">syn1</span> <span class="op">=</span> <span class="va">syn1</span> <span class="op">+</span> <span class="fl">0.1</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">syn1</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
#&gt; [1,]  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1   0.1
#&gt; [2,]  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1   0.1
#&gt; [3,]  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1   0.1
#&gt; [4,]  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1   0.1
#&gt; [5,]  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1   0.1</code></pre>
<p>And the dot product of both:</p>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">np</span><span class="op">$</span><span class="fu">dot</span><span class="op">(</span><span class="va">syn0</span>, <span class="va">syn1</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10]
#&gt; [1,] 0.228 0.228 0.228 0.228 0.228 0.228 0.228 0.228 0.228 0.228
#&gt; [2,] 0.172 0.172 0.172 0.172 0.172 0.172 0.172 0.172 0.172 0.172
#&gt; [3,] 0.295 0.295 0.295 0.295 0.295 0.295 0.295 0.295 0.295 0.295</code></pre>
<div id="python-tuples-and-r-vectors" class="section level3" number="5.3.1">
<h3>
<span class="header-section-number">5.3.1</span> Python tuples and R vectors<a class="anchor" aria-label="anchor" href="#python-tuples-and-r-vectors"><i class="fas fa-link"></i></a>
</h3>
<p>In <code>numpy</code> the shape of a multidimensional array needs to be defined using a <code>tuple</code>. in R we do it instead with a <code>vector</code>. There are not tuples in R.</p>
<p>In Python, we use a tuple, <code>(5, 5)</code> to indicate the shape of the array:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb162-1"><a href="tensors.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb162-2"><a href="tensors.html#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.ones((<span class="dv">5</span>, <span class="dv">5</span>)))</span></code></pre></div>
<pre><code>#&gt; [[1. 1. 1. 1. 1.]
#&gt;  [1. 1. 1. 1. 1.]
#&gt;  [1. 1. 1. 1. 1.]
#&gt;  [1. 1. 1. 1. 1.]
#&gt;  [1. 1. 1. 1. 1.]]</code></pre>
<p>In R, we use a vector <code><a href="https://rdrr.io/r/base/c.html">c(5L, 5L)</a></code>. The <code>L</code> indicates an integer.</p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">l1</span> <span class="op">&lt;-</span> <span class="va">np</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">l1</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt;      [,1] [,2] [,3] [,4] [,5]
#&gt; [1,]    1    1    1    1    1
#&gt; [2,]    1    1    1    1    1
#&gt; [3,]    1    1    1    1    1
#&gt; [4,]    1    1    1    1    1
#&gt; [5,]    1    1    1    1    1</code></pre>
</div>
<div id="a-numpy-array-from-r-vectors" class="section level3" number="5.3.2">
<h3>
<span class="header-section-number">5.3.2</span> A numpy array from R vectors<a class="anchor" aria-label="anchor" href="#a-numpy-array-from-r-vectors"><i class="fas fa-link"></i></a>
</h3>
<p>For this matrix, or 2D tensor, we use three R vectors:</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">np</span><span class="op">$</span><span class="fu">array</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    1    2    3
#&gt; [2,]    4    5    6
#&gt; [3,]    7    8    9</code></pre>
<p>And we could transpose the array using <code>numpy</code> as well:</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">np</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    1    4    7
#&gt; [2,]    2    5    8
#&gt; [3,]    3    6    9</code></pre>
</div>
<div id="numpy-arrays-to-tensors" class="section level3" number="5.3.3">
<h3>
<span class="header-section-number">5.3.3</span> numpy arrays to tensors<a class="anchor" aria-label="anchor" href="#numpy-arrays-to-tensors"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">=</span> <span class="va">np</span><span class="op">$</span><span class="fu">array</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>   <span class="co"># a numpy array</span>
<span class="va">t</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">as_tensor</span><span class="op">(</span><span class="va">a</span><span class="op">)</span>        <span class="co"># convert it to tensor</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([1., 2., 3.])</code></pre>
</div>
<div id="create-and-fill-a-tensor" class="section level3" number="5.3.4">
<h3>
<span class="header-section-number">5.3.4</span> Create and fill a tensor<a class="anchor" aria-label="anchor" href="#create-and-fill-a-tensor"><i class="fas fa-link"></i></a>
</h3>
<p>We can create the tensor directly from R using <code>tensor()</code>:</p>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> <span class="fl">1</span>,  <span class="fl">2</span>,  <span class="fl">3</span><span class="op">)</span><span class="op">)</span>   <span class="co"># create a tensor</span>
<span class="va">t</span><span class="op">[</span><span class="fl">1L</span><span class="op">]</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>                  <span class="co"># fill element with -1</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([1., 2., 3.])
#&gt; tensor(-1.)
#&gt; [1] -1  2  3</code></pre>
</div>
<div id="tensor-to-array-and-viceversa" class="section level3" number="5.3.5">
<h3>
<span class="header-section-number">5.3.5</span> Tensor to array, and viceversa<a class="anchor" aria-label="anchor" href="#tensor-to-array-and-viceversa"><i class="fas fa-link"></i></a>
</h3>
<p>This is a very common operation in machine learning:</p>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># convert tensor to a numpy array</span>
<span class="va">a</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">rand</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">4L</span><span class="op">)</span>
<span class="va">b</span> <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt;        [,1]   [,2]  [,3]   [,4]
#&gt; [1,] 0.0496 0.0971 0.321 0.0836
#&gt; [2,] 0.0963 0.3515 0.180 0.4117
#&gt; [3,] 0.9172 0.6132 0.459 0.3886
#&gt; [4,] 0.4897 0.6488 0.252 0.1562
#&gt; [5,] 0.7528 0.0970 0.860 0.0822</code></pre>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># convert a numpy array to a tensor</span>
<span class="va">np_a</span> <span class="op">=</span> <span class="va">np</span><span class="op">$</span><span class="fu">array</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">t_a</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">from_numpy</span><span class="op">(</span><span class="va">np_a</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">t_a</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([3., 4., 3., 6.])</code></pre>
</div>
</div>
<div id="create-tensors" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> Create tensors<a class="anchor" aria-label="anchor" href="#create-tensors"><i class="fas fa-link"></i></a>
</h2>
<p>A random 1D tensor:</p>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ft1</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="va">np</span><span class="op">$</span><span class="va">random</span><span class="op">$</span><span class="fu">rand</span><span class="op">(</span><span class="fl">5L</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ft1</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([0.8830, 0.2745, 0.8810, 0.3567, 0.0459], dtype=torch.float32)</code></pre>
<p>Force a tensor as a <code>float</code> of 64-bits:</p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ft2</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">as_tensor</span><span class="op">(</span><span class="va">np</span><span class="op">$</span><span class="va">random</span><span class="op">$</span><span class="fu">rand</span><span class="op">(</span><span class="fl">5L</span><span class="op">)</span>, dtype<span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="va">float64</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ft2</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([0.8784, 0.2209, 0.8844, 0.1705, 0.9309])</code></pre>
<p>Convert the tensor to a <code>float</code> of 16-bits:</p>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ft2_dbl</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">as_tensor</span><span class="op">(</span><span class="va">ft2</span>, dtype <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="va">float16</span><span class="op">)</span>
<span class="va">ft2_dbl</span></code></pre></div>
<pre><code>#&gt; tensor([0.8784, 0.2208, 0.8843, 0.1704, 0.9312], dtype=torch.float16)</code></pre>
<p>Create a tensor of size (5 x 7) with uninitialized memory:</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">7L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[7.5670e-44, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
#&gt;          0.0000e+00],
#&gt;         [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
#&gt;          0.0000e+00],
#&gt;         [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
#&gt;          0.0000e+00],
#&gt;         [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
#&gt;          0.0000e+00],
#&gt;         [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
#&gt;          0.0000e+00]], dtype=torch.float32)</code></pre>
<p>Using arange to create a tensor. <code>arange</code> starts at 0.</p>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">9L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([0, 1, 2, 3, 4, 5, 6, 7, 8])</code></pre>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># reshape</span>
<span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">v</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[0, 1, 2],
#&gt;         [3, 4, 5],
#&gt;         [6, 7, 8]])</code></pre>
<div id="tensor-fill" class="section level3" number="5.4.1">
<h3>
<span class="header-section-number">5.4.1</span> Tensor fill<a class="anchor" aria-label="anchor" href="#tensor-fill"><i class="fas fa-link"></i></a>
</h3>
<p>On this tensor:</p>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[1., 1., 1.],
#&gt;         [1., 1., 1.],
#&gt;         [1., 1., 1.]])</code></pre>
<p>Fill row 1 with 2s:</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">v</span><span class="op">[</span><span class="fl">1L</span>, <span class="op">]</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="fl">2L</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[2., 2., 2.],
#&gt;         [1., 1., 1.],
#&gt;         [1., 1., 1.]])</code></pre>
<p>Fill row 2 with 3s:</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">v</span><span class="op">[</span><span class="fl">2L</span>, <span class="op">]</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="fl">3L</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[2., 2., 2.],
#&gt;         [3., 3., 3.],
#&gt;         [1., 1., 1.]])</code></pre>
<p>Fill column 3 with fours (4):</p>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">v</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="fl">4L</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[2., 2., 4.],
#&gt;         [3., 3., 4.],
#&gt;         [1., 1., 4.]])</code></pre>
</div>
<div id="tensor-with-a-range-of-values" class="section level3" number="5.4.2">
<h3>
<span class="header-section-number">5.4.2</span> Tensor with a range of values<a class="anchor" aria-label="anchor" href="#tensor-with-a-range-of-values"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Initialize Tensor with a range of value</span>
<span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">10L</span><span class="op">)</span>             <span class="co"># similar to range(5) but creating a Tensor</span>
<span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">10L</span>, step <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Size 5. Similar to range(0, 5, 1)</span></code></pre></div>
<pre><code>#&gt; tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</code></pre>
</div>
<div id="linear-or-log-scale-tensor" class="section level3" number="5.4.3">
<h3>
<span class="header-section-number">5.4.3</span> Linear or log scale Tensor<a class="anchor" aria-label="anchor" href="#linear-or-log-scale-tensor"><i class="fas fa-link"></i></a>
</h3>
<p>Create a tensor with 10 linear points for (1, 10) inclusive:</p>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">linspace</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">10L</span>, steps <span class="op">=</span> <span class="fl">10L</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<pre><code>#&gt; tensor([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10.])</code></pre>
<p>Create a tensor with 10 logarithmic points for (1, 10) inclusive:</p>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">logspace</span><span class="op">(</span>start<span class="op">=</span><span class="op">-</span><span class="fl">10L</span>, end <span class="op">=</span> <span class="fl">10L</span>, steps <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<pre><code>#&gt; tensor([1.0000e-10, 1.0000e-05, 1.0000e+00, 1.0000e+05, 1.0000e+10])</code></pre>
</div>
<div id="in-place-out-of-place-fill" class="section level3" number="5.4.4">
<h3>
<span class="header-section-number">5.4.4</span> In-place / Out-of-place fill<a class="anchor" aria-label="anchor" href="#in-place-out-of-place-fill"><i class="fas fa-link"></i></a>
</h3>
<p>On this uninitialized tensor:</p>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">7L</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[-3.2069e+28,  4.5719e-41,  4.5986e-10,  3.0893e-41,  0.0000e+00,
#&gt;           0.0000e+00,  0.0000e+00],
#&gt;         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
#&gt;           5.6723e-11,  3.0893e-41],
#&gt;         [ 0.0000e+00,  0.0000e+00,  2.2390e-11,  3.0893e-41,  2.2390e-11,
#&gt;           3.0893e-41,  2.2390e-11],
#&gt;         [ 3.0893e-41,  7.0065e-45,  0.0000e+00,  0.0000e+00,  0.0000e+00,
#&gt;           0.0000e+00,  0.0000e+00],
#&gt;         [-3.0322e+14,  4.5719e-41,  0.0000e+00,  0.0000e+00,  2.2390e-11,
#&gt;           3.0893e-41,  2.2390e-11]], dtype=torch.float32)</code></pre>
<p>Fill the tensor with the value 3.5:</p>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="fl">3.5</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000],
#&gt;         [3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000],
#&gt;         [3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000],
#&gt;         [3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000],
#&gt;         [3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000]],
#&gt;        dtype=torch.float32)</code></pre>
<p>Add a scalar to the tensor:</p>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="fl">4.0</span><span class="op">)</span></code></pre></div>
<p>The tensor <code>a</code> is still filled with 3.5. A new tensor <code>b</code> is returned with values 3.5 + 4.0 = 7.5</p>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000],
#&gt;         [3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000],
#&gt;         [3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000],
#&gt;         [3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000],
#&gt;         [3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000, 3.5000]],
#&gt;        dtype=torch.float32)
#&gt; tensor([[7.5000, 7.5000, 7.5000, 7.5000, 7.5000, 7.5000, 7.5000],
#&gt;         [7.5000, 7.5000, 7.5000, 7.5000, 7.5000, 7.5000, 7.5000],
#&gt;         [7.5000, 7.5000, 7.5000, 7.5000, 7.5000, 7.5000, 7.5000],
#&gt;         [7.5000, 7.5000, 7.5000, 7.5000, 7.5000, 7.5000, 7.5000],
#&gt;         [7.5000, 7.5000, 7.5000, 7.5000, 7.5000, 7.5000, 7.5000]],
#&gt;        dtype=torch.float32)</code></pre>
</div>
</div>
<div id="tensor-resizing" class="section level2" number="5.5">
<h2>
<span class="header-section-number">5.5</span> Tensor resizing<a class="anchor" aria-label="anchor" href="#tensor-resizing"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">randn</span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span>            <span class="co"># Size 2x3</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; tensor([[-0.0999, -0.0920,  1.8464],</span>
<span class="co">#&gt;         [ 2.7680, -0.9260, -1.0860]])</span>

<span class="va">y</span> <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="fl">6L</span><span class="op">)</span>                     <span class="co"># Resize x to size 6</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; tensor([-0.0999, -0.0920,  1.8464,  2.7680, -0.9260, -1.0860])</span>

<span class="va">z</span> <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="op">-</span><span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span>                <span class="co"># Size 3x2</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>
<span class="co">#&gt; tensor([[-0.0999, -0.0920],</span>
<span class="co">#&gt;         [ 1.8464,  2.7680],</span>
<span class="co">#&gt;         [-0.9260, -1.0860]])</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">z</span><span class="op">$</span><span class="va">shape</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([3, 2])</span></code></pre></div>
<div id="exercise" class="section level3" number="5.5.1">
<h3>
<span class="header-section-number">5.5.1</span> Exercise<a class="anchor" aria-label="anchor" href="#exercise"><i class="fas fa-link"></i></a>
</h3>
<p>Reproduce this tensor:</p>
<pre><code> 0 1 2
 3 4 5
 6 7 8</code></pre>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a vector with the number of elements</span>
<span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">arange</span><span class="op">(</span><span class="fl">9L</span><span class="op">)</span>

<span class="co"># resize to a 3x3 tensor</span>
<span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">v</span><span class="op">$</span><span class="fu">view</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">3L</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[0, 1, 2],
#&gt;         [3, 4, 5],
#&gt;         [6, 7, 8]])</code></pre>
</div>
</div>
<div id="concatenate-tensors" class="section level2" number="5.6">
<h2>
<span class="header-section-number">5.6</span> Concatenate tensors<a class="anchor" aria-label="anchor" href="#concatenate-tensors"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">randn</span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">shape</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[ 0.8657, -0.1748, -0.9896],
#&gt;         [ 0.2095, -0.1623,  1.1728]])
#&gt; torch.Size([2, 3])</code></pre>
<div id="concatenate-by-rows" class="section level3" number="5.6.1">
<h3>
<span class="header-section-number">5.6.1</span> Concatenate by rows<a class="anchor" aria-label="anchor" href="#concatenate-by-rows"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">x0</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">cat</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span><span class="op">)</span>, <span class="fl">0L</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x0</span><span class="op">$</span><span class="va">shape</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[ 0.8657, -0.1748, -0.9896],
#&gt;         [ 0.2095, -0.1623,  1.1728],
#&gt;         [ 0.8657, -0.1748, -0.9896],
#&gt;         [ 0.2095, -0.1623,  1.1728],
#&gt;         [ 0.8657, -0.1748, -0.9896],
#&gt;         [ 0.2095, -0.1623,  1.1728]])
#&gt; torch.Size([6, 3])</code></pre>
</div>
<div id="concatenate-by-columns" class="section level3" number="5.6.2">
<h3>
<span class="header-section-number">5.6.2</span> Concatenate by columns<a class="anchor" aria-label="anchor" href="#concatenate-by-columns"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">cat</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span><span class="op">)</span>, <span class="fl">1L</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x1</span><span class="op">$</span><span class="va">shape</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[ 0.8657, -0.1748, -0.9896,  0.8657, -0.1748, -0.9896,  0.8657, -0.1748,
#&gt;          -0.9896],
#&gt;         [ 0.2095, -0.1623,  1.1728,  0.2095, -0.1623,  1.1728,  0.2095, -0.1623,
#&gt;           1.1728]])
#&gt; torch.Size([2, 9])</code></pre>
</div>
</div>
<div id="reshape-tensors" class="section level2" number="5.7">
<h2>
<span class="header-section-number">5.7</span> Reshape tensors<a class="anchor" aria-label="anchor" href="#reshape-tensors"><i class="fas fa-link"></i></a>
</h2>
<div id="with-chunk" class="section level3" number="5.7.1">
<h3>
<span class="header-section-number">5.7.1</span> With <code>chunk()</code>:<a class="anchor" aria-label="anchor" href="#with-chunk"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s say this is an image tensor with the 3-channels and 28x28 pixels</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ----- Reshape tensors -----</span>
<span class="va">img</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">28L</span>, <span class="fl">28L</span><span class="op">)</span>  <span class="co"># Create the tensor of ones</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; torch.Size([3, 28, 28])</code></pre>
<p>On the first dimension <code>dim = 0L</code>, reshape the tensor:</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">img_chunks</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">chunk</span><span class="op">(</span><span class="va">img</span>, chunks <span class="op">=</span> <span class="fl">3L</span>, dim <span class="op">=</span> <span class="fl">0L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">img_chunks</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">img_chunks</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; [1] 3
#&gt; [1] "list"</code></pre>
<p><code>img_chunks</code> is a <code>list</code> of three members.</p>
<p>The first chunk member:</p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 1st chunk member</span>
<span class="va">img_chunk</span> <span class="op">&lt;-</span> <span class="va">img_chunks</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_chunk</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_chunk</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>      <span class="co"># if the tensor had all ones, what is the sum?</span></code></pre></div>
<pre><code>#&gt; torch.Size([1, 28, 28])
#&gt; tensor(784.)</code></pre>
<p>The second chunk member:</p>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 2nd chunk member</span>
<span class="va">img_chunk</span> <span class="op">&lt;-</span> <span class="va">img_chunks</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_chunk</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_chunk</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>        <span class="co"># if the tensor had all ones, what is the sum?</span></code></pre></div>
<pre><code>#&gt; torch.Size([1, 28, 28])
#&gt; tensor(784.)</code></pre>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 3rd chunk member</span>
<span class="va">img_chunk</span> <span class="op">&lt;-</span> <span class="va">img_chunks</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_chunk</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_chunk</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>        <span class="co"># if the tensor had all ones, what is the sum?</span></code></pre></div>
<pre><code>#&gt; torch.Size([1, 28, 28])
#&gt; tensor(784.)</code></pre>
<div id="exercise-1" class="section level4" number="5.7.1.1">
<h4>
<span class="header-section-number">5.7.1.1</span> Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>Create a tensor of shape 3x28x28 filled with values 0.25 on the first channel</li>
<li>The second channel with 0.5</li>
<li>The third chanel with 0.75</li>
<li>Find the sum for ecah separate channel</li>
<li>Find the sum of all channels</li>
</ol>
</div>
</div>
<div id="with-index_select" class="section level3" number="5.7.2">
<h3>
<span class="header-section-number">5.7.2</span> With <code>index_select()</code>:<a class="anchor" aria-label="anchor" href="#with-index_select"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">img</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">28L</span>, <span class="fl">28L</span><span class="op">)</span>  <span class="co"># Create the tensor of ones</span>
<span class="va">img</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; torch.Size([3, 28, 28])</code></pre>
<p>This is the layer 1:</p>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># index_select. get layer 1</span>
<span class="va">indices</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0L</span><span class="op">)</span><span class="op">)</span>
<span class="va">img_layer_1</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">index_select</span><span class="op">(</span><span class="va">img</span>, dim <span class="op">=</span> <span class="fl">0L</span>, index <span class="op">=</span> <span class="va">indices</span><span class="op">)</span></code></pre></div>
<p>The size of the layer:</p>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_layer_1</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; torch.Size([1, 28, 28])</code></pre>
<p>The sum of all elements in that layer:</p>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_layer_1</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor(784.)</code></pre>
<p>This is the layer 2:</p>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># index_select. get layer 2</span>
<span class="va">indices</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1L</span><span class="op">)</span><span class="op">)</span>
<span class="va">img_layer_2</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">index_select</span><span class="op">(</span><span class="va">img</span>, dim <span class="op">=</span> <span class="fl">0L</span>, index <span class="op">=</span> <span class="va">indices</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_layer_2</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_layer_2</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; torch.Size([1, 28, 28])
#&gt; tensor(784.)</code></pre>
<p>This is the layer 3:</p>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># index_select. get layer 3</span>
<span class="va">indices</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2L</span><span class="op">)</span><span class="op">)</span>
<span class="va">img_layer_3</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">index_select</span><span class="op">(</span><span class="va">img</span>, dim <span class="op">=</span> <span class="fl">0L</span>, index <span class="op">=</span> <span class="va">indices</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_layer_3</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">img_layer_3</span><span class="op">$</span><span class="fu">sum</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; torch.Size([1, 28, 28])
#&gt; tensor(784.)</code></pre>
</div>
</div>
<div id="special-tensors" class="section level2" number="5.8">
<h2>
<span class="header-section-number">5.8</span> Special tensors<a class="anchor" aria-label="anchor" href="#special-tensors"><i class="fas fa-link"></i></a>
</h2>
<div id="identity-matrix" class="section level3" number="5.8.1">
<h3>
<span class="header-section-number">5.8.1</span> Identity matrix<a class="anchor" aria-label="anchor" href="#identity-matrix"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># identity matrix</span>
<span class="va">eye</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">eye</span><span class="op">(</span><span class="fl">3L</span><span class="op">)</span>              <span class="co"># Create an identity 3x3 tensor</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">eye</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[1., 0., 0.],
#&gt;         [0., 1., 0.],
#&gt;         [0., 0., 1.]])</code></pre>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># a 5x5 identity or unit matrix</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">eye</span><span class="op">(</span><span class="fl">5L</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[1., 0., 0., 0., 0.],
#&gt;         [0., 1., 0., 0., 0.],
#&gt;         [0., 0., 1., 0., 0.],
#&gt;         [0., 0., 0., 1., 0.],
#&gt;         [0., 0., 0., 0., 1.]])</code></pre>
</div>
<div id="ones" class="section level3" number="5.8.2">
<h3>
<span class="header-section-number">5.8.2</span> Ones<a class="anchor" aria-label="anchor" href="#ones"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">10L</span><span class="op">)</span><span class="op">)</span>               <span class="co"># A tensor of size 10 containing all ones</span>

<span class="co"># reshape</span>
<span class="op">(</span><span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">1L</span><span class="op">)</span><span class="op">)</span>     <span class="co"># Size 2x1x2x1, a 4D tensor</span></code></pre></div>
<pre><code>#&gt; tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1.])
#&gt; tensor([[[[1.],
#&gt;           [1.]]],
#&gt; 
#&gt; 
#&gt;         [[[1.],
#&gt;           [1.]]]])</code></pre>
<p>The <em>matrix of ones</em> is also called `<code>unitary matrix</code>. This is a <code>4x4</code> unitary matrix.</p>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">4L</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[1., 1., 1., 1.],
#&gt;         [1., 1., 1., 1.],
#&gt;         [1., 1., 1., 1.],
#&gt;         [1., 1., 1., 1.]])</code></pre>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># eye tensor</span>
<span class="va">eye</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">eye</span><span class="op">(</span><span class="fl">3L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">eye</span><span class="op">)</span>
<span class="co"># like eye tensor</span>
<span class="va">v</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones_like</span><span class="op">(</span><span class="va">eye</span><span class="op">)</span>     <span class="co"># A tensor with same shape as eye. Fill it with 1.</span>
<span class="va">v</span></code></pre></div>
<pre><code>#&gt; tensor([[1., 0., 0.],
#&gt;         [0., 1., 0.],
#&gt;         [0., 0., 1.]])
#&gt; tensor([[1., 1., 1.],
#&gt;         [1., 1., 1.],
#&gt;         [1., 1., 1.]])</code></pre>
</div>
<div id="zeros" class="section level3" number="5.8.3">
<h3>
<span class="header-section-number">5.8.3</span> Zeros<a class="anchor" aria-label="anchor" href="#zeros"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb252"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">z</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">zeros</span><span class="op">(</span><span class="fl">10L</span><span class="op">)</span><span class="op">)</span>             <span class="co"># A tensor of size 10 containing all zeros</span></code></pre></div>
<pre><code>#&gt; tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])</code></pre>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># matrix of zeros</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">zeros</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">4L</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[0., 0., 0., 0.],
#&gt;         [0., 0., 0., 0.],
#&gt;         [0., 0., 0., 0.],
#&gt;         [0., 0., 0., 0.]])</code></pre>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># a 3D tensor of zeros</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">zeros</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">4L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[[0., 0.],
#&gt;          [0., 0.],
#&gt;          [0., 0.],
#&gt;          [0., 0.]],
#&gt; 
#&gt;         [[0., 0.],
#&gt;          [0., 0.],
#&gt;          [0., 0.],
#&gt;          [0., 0.]],
#&gt; 
#&gt;         [[0., 0.],
#&gt;          [0., 0.],
#&gt;          [0., 0.],
#&gt;          [0., 0.]]])</code></pre>
</div>
<div id="diagonal-operations" class="section level3" number="5.8.4">
<h3>
<span class="header-section-number">5.8.4</span> Diagonal operations<a class="anchor" aria-label="anchor" href="#diagonal-operations"><i class="fas fa-link"></i></a>
</h3>
<p>Given the 1D tensor</p>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span><span class="op">)</span>
<span class="va">a</span></code></pre></div>
<pre><code>#&gt; tensor([1, 2, 3])</code></pre>
<div id="diagonal-matrix" class="section level4" number="5.8.4.1">
<h4>
<span class="header-section-number">5.8.4.1</span> Diagonal matrix<a class="anchor" aria-label="anchor" href="#diagonal-matrix"><i class="fas fa-link"></i></a>
</h4>
<p>We want to fill the main diagonal with the vector:</p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">torch</span><span class="op">$</span><span class="fu">diag</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[1, 0, 0],
#&gt;         [0, 2, 0],
#&gt;         [0, 0, 3]])</code></pre>
<p>What about filling the diagonal above the main:</p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">torch</span><span class="op">$</span><span class="fu">diag</span><span class="op">(</span><span class="va">a</span>, <span class="fl">1L</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[0, 1, 0, 0],
#&gt;         [0, 0, 2, 0],
#&gt;         [0, 0, 0, 3],
#&gt;         [0, 0, 0, 0]])</code></pre>
<p>Or the diagonal below the main:</p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">torch</span><span class="op">$</span><span class="fu">diag</span><span class="op">(</span><span class="va">a</span>, <span class="op">-</span><span class="fl">1L</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[0, 0, 0, 0],
#&gt;         [1, 0, 0, 0],
#&gt;         [0, 2, 0, 0],
#&gt;         [0, 0, 3, 0]])</code></pre>
</div>
</div>
</div>
<div id="access-to-tensor-elements" class="section level2" number="5.9">
<h2>
<span class="header-section-number">5.9</span> Access to tensor elements<a class="anchor" aria-label="anchor" href="#access-to-tensor-elements"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># replace an element at position 0, 0</span>
<span class="op">(</span><span class="va">new_tensor</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">Tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[1., 2.],
#&gt;         [3., 4.]])</code></pre>
<p>Print element at position <code>1,1</code>:</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">new_tensor</span><span class="op">[</span><span class="fl">1L</span>, <span class="fl">1L</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor(1.)</code></pre>
<p>Fill element at position <code>1,1</code> with 5:</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_tensor</span><span class="op">[</span><span class="fl">1L</span>, <span class="fl">1L</span><span class="op">]</span><span class="op">$</span><span class="fu">fill_</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor(5.)</code></pre>
<p>Show the modified tensor:</p>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">new_tensor</span><span class="op">)</span>   <span class="co"># tensor([[ 5.,  2.],[ 3.,  4.]])</span></code></pre></div>
<pre><code>#&gt; tensor([[5., 2.],
#&gt;         [3., 4.]])</code></pre>
<p>Access an element at position <code>1, 0</code>:</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">new_tensor</span><span class="op">[</span><span class="fl">2L</span>, <span class="fl">1L</span><span class="op">]</span><span class="op">)</span>           <span class="co"># tensor([ 3.])</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">new_tensor</span><span class="op">[</span><span class="fl">2L</span>, <span class="fl">1L</span><span class="op">]</span><span class="op">$</span><span class="fu">item</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>    <span class="co"># 3.</span></code></pre></div>
<pre><code>#&gt; tensor(3.)
#&gt; [1] 3</code></pre>
<div id="indices-to-tensor-elements" class="section level3" number="5.9.1">
<h3>
<span class="header-section-number">5.9.1</span> Indices to tensor elements<a class="anchor" aria-label="anchor" href="#indices-to-tensor-elements"><i class="fas fa-link"></i></a>
</h3>
<p>On this tensor:</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">randn</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">4L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[-0.0156, -1.8155,  1.2381,  0.1425],
#&gt;         [-0.4337, -2.4449, -1.3382, -1.5677],
#&gt;         [ 1.9066, -0.4448,  0.5842,  0.0369]])</code></pre>
<p>Select indices, <code>dim=0</code>:</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">indices</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span>
<span class="va">torch</span><span class="op">$</span><span class="fu">index_select</span><span class="op">(</span><span class="va">x</span>, <span class="fl">0L</span>, <span class="va">indices</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[-0.0156, -1.8155,  1.2381,  0.1425],
#&gt;         [ 1.9066, -0.4448,  0.5842,  0.0369]])</code></pre>
<p>Select indices, <code>dim=1</code>:</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">torch</span><span class="op">$</span><span class="fu">index_select</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1L</span>, <span class="va">indices</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[-0.0156,  1.2381],
#&gt;         [-0.4337, -1.3382],
#&gt;         [ 1.9066,  0.5842]])</code></pre>
</div>
<div id="using-the-take-function" class="section level3" number="5.9.2">
<h3>
<span class="header-section-number">5.9.2</span> Using the <code>take</code> function<a class="anchor" aria-label="anchor" href="#using-the-take-function"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Take by indices</span>
<span class="va">src</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>,
                        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">src</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span> <span class="va">torch</span><span class="op">$</span><span class="fu">take</span><span class="op">(</span><span class="va">src</span>, <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">2L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[4., 3., 5.],
#&gt;         [6., 7., 8.]])
#&gt; tensor([4., 5., 8.])</code></pre>
</div>
</div>
<div id="other-tensor-operations" class="section level2" number="5.10">
<h2>
<span class="header-section-number">5.10</span> Other tensor operations<a class="anchor" aria-label="anchor" href="#other-tensor-operations"><i class="fas fa-link"></i></a>
</h2>
<div id="cross-product" class="section level3" number="5.10.1">
<h3>
<span class="header-section-number">5.10.1</span> Cross product<a class="anchor" aria-label="anchor" href="#cross-product"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span>
<span class="va">m2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span>
<span class="va">v1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">3L</span><span class="op">)</span>
<span class="co"># Cross product</span>
<span class="co"># Size 3x5</span>
<span class="op">(</span><span class="va">r</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">cross</span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; tensor([[0., 0., 0., 0., 0.],
#&gt;         [0., 0., 0., 0., 0.],
#&gt;         [0., 0., 0., 0., 0.]])</code></pre>
</div>
<div id="dot-product" class="section level3" number="5.10.2">
<h3>
<span class="header-section-number">5.10.2</span> Dot product<a class="anchor" aria-label="anchor" href="#dot-product"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Dot product of 2 tensors</span>
<span class="co"># Dot product of 2 tensors</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">Tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span>
<span class="va">q</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">Tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">1L</span><span class="op">)</span><span class="op">)</span>                   

<span class="op">(</span><span class="va">r</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">dot</span><span class="op">(</span><span class="va">p</span>, <span class="va">q</span><span class="op">)</span><span class="op">)</span>  <span class="co"># 14</span>
<span class="co">#&gt; tensor(14.)</span>
<span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">%.*%</span> <span class="va">q</span><span class="op">)</span>        <span class="co"># 14</span>
<span class="co">#&gt; tensor(14.)</span></code></pre></div>
</div>
</div>
<div id="logical-operations" class="section level2" number="5.11">
<h2>
<span class="header-section-number">5.11</span> Logical operations<a class="anchor" aria-label="anchor" href="#logical-operations"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m0</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">zeros</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span>
<span class="va">m1</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span>
<span class="va">m2</span> <span class="op">=</span> <span class="va">torch</span><span class="op">$</span><span class="fu">eye</span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">5L</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">m1</span> <span class="op">==</span> <span class="va">m0</span><span class="op">)</span>
<span class="co">#&gt; tensor([[False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False]])</span></code></pre></div>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">m1</span> <span class="op">!=</span> <span class="va">m1</span><span class="op">)</span>
<span class="co">#&gt; tensor([[False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False],</span>
<span class="co">#&gt;         [False, False, False, False, False]])</span></code></pre></div>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">m2</span> <span class="op">==</span> <span class="va">m2</span><span class="op">)</span>
<span class="co">#&gt; tensor([[True, True, True, True, True],</span>
<span class="co">#&gt;         [True, True, True, True, True],</span>
<span class="co">#&gt;         [True, True, True, True, True]])</span></code></pre></div>
<div class="sourceCode" id="cb290"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># AND</span>
<span class="va">m1</span> <span class="op">&amp;</span> <span class="va">m1</span>
<span class="co">#&gt; tensor([[1, 1, 1, 1, 1],</span>
<span class="co">#&gt;         [1, 1, 1, 1, 1],</span>
<span class="co">#&gt;         [1, 1, 1, 1, 1]], dtype=torch.uint8)</span></code></pre></div>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># OR</span>
<span class="va">m0</span> <span class="op">|</span> <span class="va">m2</span>
<span class="co">#&gt; tensor([[1, 0, 0, 0, 0],</span>
<span class="co">#&gt;         [0, 1, 0, 0, 0],</span>
<span class="co">#&gt;         [0, 0, 1, 0, 0]], dtype=torch.uint8)</span></code></pre></div>
<div class="sourceCode" id="cb292"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># OR</span>
<span class="va">m1</span> <span class="op">|</span> <span class="va">m2</span>
<span class="co">#&gt; tensor([[1, 1, 1, 1, 1],</span>
<span class="co">#&gt;         [1, 1, 1, 1, 1],</span>
<span class="co">#&gt;         [1, 1, 1, 1, 1]], dtype=torch.uint8)</span></code></pre></div>
<div id="extract-a-unique-logical-result" class="section level3" number="5.11.1">
<h3>
<span class="header-section-number">5.11.1</span> Extract a unique logical result<a class="anchor" aria-label="anchor" href="#extract-a-unique-logical-result"><i class="fas fa-link"></i></a>
</h3>
<p>With <code>all</code>:</p>
<div class="sourceCode" id="cb293"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># tensor is less than</span>
<span class="va">A</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">60000L</span>, <span class="fl">1L</span>, <span class="fl">28L</span>, <span class="fl">28L</span><span class="op">)</span>
<span class="va">C</span> <span class="op">&lt;-</span> <span class="va">A</span> <span class="op">*</span> <span class="fl">0.5</span>

<span class="co"># is C &lt; A</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">lt</span><span class="op">(</span><span class="va">C</span>, <span class="va">A</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">C</span> <span class="op">&lt;</span> <span class="va">A</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>
<span class="co"># is A &lt; C</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">A</span> <span class="op">&lt;</span> <span class="va">C</span><span class="op">)</span>
<span class="co">#&gt; tensor(0, dtype=torch.uint8)</span></code></pre></div>
<p>With function <code>all_boolean</code>:</p>
<div class="sourceCode" id="cb294"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_boolean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># convert tensor of 1s and 0s to a unique boolean</span>
  <span class="fu"><a href="https://rdrr.io/r/base/logical.html">as.logical</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">all</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># is C &lt; A</span>
<span class="fu">all_boolean</span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">lt</span><span class="op">(</span><span class="va">C</span>, <span class="va">A</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="fu">all_boolean</span><span class="op">(</span><span class="va">C</span> <span class="op">&lt;</span> <span class="va">A</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="co"># is A &lt; C</span>
<span class="fu">all_boolean</span><span class="op">(</span><span class="va">A</span> <span class="op">&lt;</span> <span class="va">C</span><span class="op">)</span>
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
</div>
<div id="greater-than-gt" class="section level3" number="5.11.2">
<h3>
<span class="header-section-number">5.11.2</span> Greater than (<code>gt</code>)<a class="anchor" aria-label="anchor" href="#greater-than-gt"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># tensor is greater than</span>
<span class="va">A</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">60000L</span>, <span class="fl">1L</span>, <span class="fl">28L</span>, <span class="fl">28L</span><span class="op">)</span>
<span class="va">D</span> <span class="op">&lt;-</span> <span class="va">A</span> <span class="op">*</span> <span class="fl">2.0</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="va">D</span>, <span class="va">A</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">gt</span><span class="op">(</span><span class="va">A</span>, <span class="va">D</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(0, dtype=torch.uint8)</span></code></pre></div>
</div>
<div id="less-than-or-equal-le" class="section level3" number="5.11.3">
<h3>
<span class="header-section-number">5.11.3</span> Less than or equal (<code>le</code>)<a class="anchor" aria-label="anchor" href="#less-than-or-equal-le"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb296"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># tensor is less than or equal</span>
<span class="va">A1</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">ones</span><span class="op">(</span><span class="fl">60000L</span>, <span class="fl">1L</span>, <span class="fl">28L</span>, <span class="fl">28L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">le</span><span class="op">(</span><span class="va">A1</span>, <span class="va">A1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">A1</span> <span class="op">&lt;=</span> <span class="va">A1</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>

<span class="co"># tensor is greater than or equal</span>
<span class="va">A0</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">zeros</span><span class="op">(</span><span class="fl">60000L</span>, <span class="fl">1L</span>, <span class="fl">28L</span>, <span class="fl">28L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">ge</span><span class="op">(</span><span class="va">A0</span>, <span class="va">A0</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">A0</span> <span class="op">&gt;=</span> <span class="va">A0</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>

<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">A1</span> <span class="op">&gt;=</span> <span class="va">A0</span><span class="op">)</span>
<span class="co">#&gt; tensor(1, dtype=torch.uint8)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">A1</span> <span class="op">&lt;=</span> <span class="va">A0</span><span class="op">)</span>
<span class="co">#&gt; tensor(0, dtype=torch.uint8)</span></code></pre></div>
</div>
<div id="logical-not" class="section level3" number="5.11.4">
<h3>
<span class="header-section-number">5.11.4</span> Logical NOT (<code>!</code>)<a class="anchor" aria-label="anchor" href="#logical-not"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_true</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">BoolTensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">all_true</span>
<span class="co">#&gt; tensor([True, True, True, True])</span>

<span class="co"># logical NOT</span>
<span class="va">not_all_true</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="va">all_true</span>
<span class="va">not_all_true</span>
<span class="co">#&gt; tensor([False, False, False, False])</span></code></pre></div>
<div class="sourceCode" id="cb298"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diag</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">eye</span><span class="op">(</span><span class="fl">5L</span><span class="op">)</span>
<span class="va">diag</span>
<span class="co">#&gt; tensor([[1., 0., 0., 0., 0.],</span>
<span class="co">#&gt;         [0., 1., 0., 0., 0.],</span>
<span class="co">#&gt;         [0., 0., 1., 0., 0.],</span>
<span class="co">#&gt;         [0., 0., 0., 1., 0.],</span>
<span class="co">#&gt;         [0., 0., 0., 0., 1.]])</span>

<span class="co"># logical NOT</span>
<span class="va">not_diag</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="va">diag</span>

<span class="co"># convert to integer</span>
<span class="va">not_diag</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span>dtype<span class="op">=</span><span class="va">torch</span><span class="op">$</span><span class="va">uint8</span><span class="op">)</span>
<span class="co">#&gt; tensor([[0, 1, 1, 1, 1],</span>
<span class="co">#&gt;         [1, 0, 1, 1, 1],</span>
<span class="co">#&gt;         [1, 1, 0, 1, 1],</span>
<span class="co">#&gt;         [1, 1, 1, 0, 1],</span>
<span class="co">#&gt;         [1, 1, 1, 1, 0]], dtype=torch.uint8)</span></code></pre></div>
</div>
</div>
<div id="distributions" class="section level2" number="5.12">
<h2>
<span class="header-section-number">5.12</span> Distributions<a class="anchor" aria-label="anchor" href="#distributions"><i class="fas fa-link"></i></a>
</h2>
<p>Initialize a tensor randomized with a normal distribution with <code>mean=0</code>, <code>var=1</code>:</p>
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">randn</span><span class="op">(</span><span class="fl">3500L</span><span class="op">)</span>
<span class="va">n</span>
<span class="co">#&gt; tensor([ 0.1694,  0.5110, -0.6642,  ...,  1.0746,  0.5686,  0.5774])</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">n</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">n</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="0201-tensors_files/figure-html/unnamed-chunk-86-1.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-86-2.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb300"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span>  <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">randn</span><span class="op">(</span><span class="fl">8L</span>, <span class="fl">5L</span>, <span class="fl">6L</span><span class="op">)</span>
<span class="co"># print(a)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="fu">size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([8, 5, 6])</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="0201-tensors_files/figure-html/unnamed-chunk-87-1.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-87-2.png" width="70%" style="display: block; margin: auto;"></p>
<div id="uniform-matrix" class="section level3" number="5.12.1">
<h3>
<span class="header-section-number">5.12.1</span> Uniform matrix<a class="anchor" aria-label="anchor" href="#uniform-matrix"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb301"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/f0nzie/rTorch">rTorch</a></span><span class="op">)</span>

<span class="co"># 3x5 matrix uniformly distributed between 0 and 1</span>
<span class="va">mat0</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">13L</span>, <span class="fl">15L</span><span class="op">)</span><span class="op">$</span><span class="fu">uniform_</span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">1L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">mat0</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">mat0</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="0201-tensors_files/figure-html/unnamed-chunk-88-1.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-88-2.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># fill a 3x5 matrix with 0.1</span>
<span class="va">mat1</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">30L</span>, <span class="fl">50L</span><span class="op">)</span><span class="op">$</span><span class="fu">uniform_</span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">mat1</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">mat1</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="0201-tensors_files/figure-html/unnamed-chunk-89-1.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-89-2.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb303"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># a vector with all ones</span>
<span class="va">mat2</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">500L</span><span class="op">)</span><span class="op">$</span><span class="fu">uniform_</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">mat2</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">mat2</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="0201-tensors_files/figure-html/unnamed-chunk-90-1.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-90-2.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div id="binomial-distribution" class="section level3" number="5.12.2">
<h3>
<span class="header-section-number">5.12.2</span> Binomial distribution<a class="anchor" aria-label="anchor" href="#binomial-distribution"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Binomial</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="va">distributions</span><span class="op">$</span><span class="va">binomial</span><span class="op">$</span><span class="va">Binomial</span>

<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">Binomial</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0</span> , <span class="fl">.2</span>, <span class="fl">.8</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">(</span><span class="va">x</span> <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([  0.,  20.,  83., 100.])</span></code></pre></div>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">Binomial</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">5.</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">10.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, 
             <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">(</span><span class="va">x</span> <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; tensor([[2., 5.],</span>
<span class="co">#&gt;         [3., 8.]])</span></code></pre></div>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">binom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">Binomial</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">torch</span><span class="op">$</span><span class="fu">FloatTensor</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">10L</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">binom</span><span class="op">)</span>
<span class="co">#&gt; Binomial(total_count: torch.Size([5, 10]), probs: torch.Size([5, 10]), logits: torch.Size([5, 10]))</span></code></pre></div>
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">binom</span><span class="op">$</span><span class="fu">sample_n</span><span class="op">(</span><span class="fl">100L</span><span class="op">)</span><span class="op">$</span><span class="va">shape</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([100, 5, 10])</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">binom</span><span class="op">$</span><span class="fu">sample_n</span><span class="op">(</span><span class="fl">100L</span><span class="op">)</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">binom</span><span class="op">$</span><span class="fu">sample_n</span><span class="op">(</span><span class="fl">100L</span><span class="op">)</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="0201-tensors_files/figure-html/unnamed-chunk-94-1.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-94-2.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div id="exponential-distribution" class="section level3" number="5.12.3">
<h3>
<span class="header-section-number">5.12.3</span> Exponential distribution<a class="anchor" aria-label="anchor" href="#exponential-distribution"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Exponential</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="va">distributions</span><span class="op">$</span><span class="va">exponential</span><span class="op">$</span><span class="va">Exponential</span>

<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">Exponential</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span>
<span class="co">#&gt; Exponential(rate: tensor([1.]))</span>
<span class="va">m</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span><span class="op">)</span>  <span class="co"># Exponential distributed with rate=1</span>
<span class="co">#&gt; tensor([0.5603])</span></code></pre></div>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">expo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">Exponential</a></span><span class="op">(</span>rate<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span>
<span class="va">expo_sample</span> <span class="op">&lt;-</span> <span class="va">expo</span><span class="op">$</span><span class="fu">sample_n</span><span class="op">(</span><span class="fl">250L</span><span class="op">)</span>   <span class="co"># generate 250 samples</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">expo_sample</span><span class="op">$</span><span class="va">shape</span><span class="op">)</span>
<span class="co">#&gt; torch.Size([250])</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">expo_sample</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">expo_sample</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="0201-tensors_files/figure-html/unnamed-chunk-96-1.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-96-2.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div id="weibull-distribution" class="section level3" number="5.12.4">
<h3>
<span class="header-section-number">5.12.4</span> Weibull distribution<a class="anchor" aria-label="anchor" href="#weibull-distribution"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Weibull</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="va">distributions</span><span class="op">$</span><span class="va">weibull</span><span class="op">$</span><span class="va">Weibull</span>

<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">Weibull</a></span><span class="op">(</span><span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span><span class="op">)</span>, <span class="va">torch</span><span class="op">$</span><span class="fu">tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span><span class="op">)</span>  <span class="co"># sample from a Weibull distribution with scale=1, concentration=1</span>
<span class="co">#&gt; tensor([0.5130])</span></code></pre></div>
<div id="constant-scale" class="section level4" number="5.12.4.1">
<h4>
<span class="header-section-number">5.12.4.1</span> Constant <code>scale</code><a class="anchor" aria-label="anchor" href="#constant-scale"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># constant scale</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">wei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">Weibull</a></span><span class="op">(</span>scale<span class="op">=</span><span class="fl">100</span>, concentration<span class="op">=</span><span class="va">k</span><span class="op">)</span>
    <span class="va">wei_sample</span> <span class="op">&lt;-</span> <span class="va">wei</span><span class="op">$</span><span class="fu">sample_n</span><span class="op">(</span><span class="fl">500L</span><span class="op">)</span>
    <span class="co"># plot(wei_sample$flatten()$numpy())</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span>main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Scale=100; Concentration="</span>, <span class="va">k</span><span class="op">)</span>,
        <span class="va">wei_sample</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="0201-tensors_files/figure-html/unnamed-chunk-98-1.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-98-2.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-98-3.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-98-4.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-98-5.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-98-6.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-98-7.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-98-8.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-98-9.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-98-10.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div id="constant-concentration" class="section level4" number="5.12.4.2">
<h4>
<span class="header-section-number">5.12.4.2</span> Constant <code>concentration</code><a class="anchor" aria-label="anchor" href="#constant-concentration"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb312"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># constant concentration</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">s</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">wei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">Weibull</a></span><span class="op">(</span>scale<span class="op">=</span><span class="va">s</span>, concentration<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
    <span class="va">wei_sample</span> <span class="op">&lt;-</span> <span class="va">wei</span><span class="op">$</span><span class="fu">sample_n</span><span class="op">(</span><span class="fl">500L</span><span class="op">)</span>
    <span class="co"># plot(wei_sample$flatten()$numpy())</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span>main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Concentration=1; Scale="</span>, <span class="va">s</span><span class="op">)</span>,
        <span class="va">wei_sample</span><span class="op">$</span><span class="fu">flatten</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="0201-tensors_files/figure-html/unnamed-chunk-99-1.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-99-2.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-99-3.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-99-4.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-99-5.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-99-6.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-99-7.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-99-8.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-99-9.png" width="70%" style="display: block; margin: auto;"><img src="0201-tensors_files/figure-html/unnamed-chunk-99-10.png" width="70%" style="display: block; margin: auto;"></p>

</div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="converting-tensors.html"><span class="header-section-number">4</span> Converting tensors</a></div>
<div class="next"><a href="linearalgebra.html"><span class="header-section-number">6</span> Linear Algebra with Torch</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#tensors"><span class="header-section-number">5</span> Tensors</a></li>
<li>
<a class="nav-link" href="#tensor-data-types"><span class="header-section-number">5.1</span> Tensor data types</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#major-tensor-types"><span class="header-section-number">5.1.1</span> Major tensor types</a></li>
<li><a class="nav-link" href="#example-a-4d-tensor"><span class="header-section-number">5.1.2</span> Example: A 4D tensor</a></li>
<li><a class="nav-link" href="#example-a-3d-tensor"><span class="header-section-number">5.1.3</span> Example: A 3D tensor</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#arithmetic-of-tensors"><span class="header-section-number">5.2</span> Arithmetic of tensors</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#add-tensors"><span class="header-section-number">5.2.1</span> Add tensors</a></li>
<li><a class="nav-link" href="#add-tensor-elements"><span class="header-section-number">5.2.2</span> Add tensor elements</a></li>
<li><a class="nav-link" href="#multiply-a-tensor-by-a-scalar"><span class="header-section-number">5.2.3</span> Multiply a tensor by a scalar</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#numpy-and-pytorch"><span class="header-section-number">5.3</span> NumPy and PyTorch</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#python-tuples-and-r-vectors"><span class="header-section-number">5.3.1</span> Python tuples and R vectors</a></li>
<li><a class="nav-link" href="#a-numpy-array-from-r-vectors"><span class="header-section-number">5.3.2</span> A numpy array from R vectors</a></li>
<li><a class="nav-link" href="#numpy-arrays-to-tensors"><span class="header-section-number">5.3.3</span> numpy arrays to tensors</a></li>
<li><a class="nav-link" href="#create-and-fill-a-tensor"><span class="header-section-number">5.3.4</span> Create and fill a tensor</a></li>
<li><a class="nav-link" href="#tensor-to-array-and-viceversa"><span class="header-section-number">5.3.5</span> Tensor to array, and viceversa</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#create-tensors"><span class="header-section-number">5.4</span> Create tensors</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#tensor-fill"><span class="header-section-number">5.4.1</span> Tensor fill</a></li>
<li><a class="nav-link" href="#tensor-with-a-range-of-values"><span class="header-section-number">5.4.2</span> Tensor with a range of values</a></li>
<li><a class="nav-link" href="#linear-or-log-scale-tensor"><span class="header-section-number">5.4.3</span> Linear or log scale Tensor</a></li>
<li><a class="nav-link" href="#in-place-out-of-place-fill"><span class="header-section-number">5.4.4</span> In-place / Out-of-place fill</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#tensor-resizing"><span class="header-section-number">5.5</span> Tensor resizing</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#exercise"><span class="header-section-number">5.5.1</span> Exercise</a></li></ul>
</li>
<li>
<a class="nav-link" href="#concatenate-tensors"><span class="header-section-number">5.6</span> Concatenate tensors</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#concatenate-by-rows"><span class="header-section-number">5.6.1</span> Concatenate by rows</a></li>
<li><a class="nav-link" href="#concatenate-by-columns"><span class="header-section-number">5.6.2</span> Concatenate by columns</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#reshape-tensors"><span class="header-section-number">5.7</span> Reshape tensors</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#with-chunk"><span class="header-section-number">5.7.1</span> With chunk():</a></li>
<li><a class="nav-link" href="#with-index_select"><span class="header-section-number">5.7.2</span> With index_select():</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#special-tensors"><span class="header-section-number">5.8</span> Special tensors</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#identity-matrix"><span class="header-section-number">5.8.1</span> Identity matrix</a></li>
<li><a class="nav-link" href="#ones"><span class="header-section-number">5.8.2</span> Ones</a></li>
<li><a class="nav-link" href="#zeros"><span class="header-section-number">5.8.3</span> Zeros</a></li>
<li><a class="nav-link" href="#diagonal-operations"><span class="header-section-number">5.8.4</span> Diagonal operations</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#access-to-tensor-elements"><span class="header-section-number">5.9</span> Access to tensor elements</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#indices-to-tensor-elements"><span class="header-section-number">5.9.1</span> Indices to tensor elements</a></li>
<li><a class="nav-link" href="#using-the-take-function"><span class="header-section-number">5.9.2</span> Using the take function</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#other-tensor-operations"><span class="header-section-number">5.10</span> Other tensor operations</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#cross-product"><span class="header-section-number">5.10.1</span> Cross product</a></li>
<li><a class="nav-link" href="#dot-product"><span class="header-section-number">5.10.2</span> Dot product</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#logical-operations"><span class="header-section-number">5.11</span> Logical operations</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#extract-a-unique-logical-result"><span class="header-section-number">5.11.1</span> Extract a unique logical result</a></li>
<li><a class="nav-link" href="#greater-than-gt"><span class="header-section-number">5.11.2</span> Greater than (gt)</a></li>
<li><a class="nav-link" href="#less-than-or-equal-le"><span class="header-section-number">5.11.3</span> Less than or equal (le)</a></li>
<li><a class="nav-link" href="#logical-not"><span class="header-section-number">5.11.4</span> Logical NOT (!)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#distributions"><span class="header-section-number">5.12</span> Distributions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#uniform-matrix"><span class="header-section-number">5.12.1</span> Uniform matrix</a></li>
<li><a class="nav-link" href="#binomial-distribution"><span class="header-section-number">5.12.2</span> Binomial distribution</a></li>
<li><a class="nav-link" href="#exponential-distribution"><span class="header-section-number">5.12.3</span> Exponential distribution</a></li>
<li><a class="nav-link" href="#weibull-distribution"><span class="header-section-number">5.12.4</span> Weibull distribution</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/f0nzie/rtorch-minimal-book/blob/master/0201-tensors.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/f0nzie/rtorch-minimal-book/edit/master/0201-tensors.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Minimal rTorch Book</strong>" was written by Alfonso R. Reyes. It was last built on 2020-11-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>B Activation Functions | A Minimal rTorch Book</title>
<meta name="author" content="Alfonso R. Reyes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.5.3/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.16/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Minimal rTorch Book</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prerequisites</a></li>
<li class="book-part">Getting Started</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="pytorch-and-numpy.html"><span class="header-section-number">2</span> PyTorch and NumPy</a></li>
<li><a class="" href="rtorch-vs-pytorch.html"><span class="header-section-number">3</span> rTorch vs PyTorch</a></li>
<li><a class="" href="converting-tensors.html"><span class="header-section-number">4</span> Converting tensors</a></li>
<li class="book-part">Basic Tensor Operations</li>
<li><a class="" href="tensors.html"><span class="header-section-number">5</span> Tensors</a></li>
<li><a class="" href="linearalgebra.html"><span class="header-section-number">6</span> Linear Algebra with Torch</a></li>
<li><a class="" href="creating-pytorch-classes.html"><span class="header-section-number">7</span> Creating PyTorch classes</a></li>
<li class="book-part">Logistic Regression</li>
<li><a class="" href="example-1-a-classification-problem.html"><span class="header-section-number">8</span> Example 1: A classification problem</a></li>
<li><a class="" href="mnistdigits.html"><span class="header-section-number">9</span> Example 2: MNIST handwritten digits</a></li>
<li class="book-part">Linear Regression</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">10</span> Linear Regression</a></li>
<li><a class="" href="linear-regression-1.html"><span class="header-section-number">11</span> Linear Regression</a></li>
<li class="book-part">Neural Networks</li>
<li><a class="" href="neural-networks.html"><span class="header-section-number">12</span> Neural Networks</a></li>
<li><a class="" href="a-neural-network-step-by-step.html"><span class="header-section-number">13</span> A neural network step-by-step</a></li>
<li class="book-part">PyTorch and R data structures</li>
<li><a class="" href="working-with-a-dataframe.html"><span class="header-section-number">14</span> Working with a data●frame</a></li>
<li><a class="" href="working-with-datatable.html"><span class="header-section-number">15</span> Working with data●table</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="appendixA.html"><span class="header-section-number">A</span> Statistical Background</a></li>
<li><a class="active" href="appendixB.html"><span class="header-section-number">B</span> Activation Functions</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/f0nzie/rtorch-minimal-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="appendixB" class="section level1" number="17">
<h1>
<span class="header-section-number">B</span> Activation Functions<a class="anchor" aria-label="anchor" href="#appendixB"><i class="fas fa-link"></i></a>
</h1>
<p><em>Last update: Thu Oct 22 16:46:28 2020 -0500 (54a46ea04)</em></p>
<div class="sourceCode" id="cb588"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/f0nzie/rTorch">rTorch</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
<div id="sigmoid" class="section level2" number="17.1">
<h2>
<span class="header-section-number">B.1</span> Sigmoid<a class="anchor" aria-label="anchor" href="#sigmoid"><i class="fas fa-link"></i></a>
</h2>
<p>Using the PyTorch <code>sigmoid()</code> function:</p>
<div class="sourceCode" id="cb589"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">range</span><span class="op">(</span><span class="op">-</span><span class="fl">5.</span>, <span class="fl">5.</span>, <span class="fl">0.1</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">sigmoid</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span>, sx <span class="op">=</span> <span class="va">y</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">sx</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Sigmoid"</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt;        x      sx
#&gt; 1   -5.0 0.00669
#&gt; 2   -4.9 0.00739
#&gt; 3   -4.8 0.00816
#&gt; 4   -4.7 0.00901
#&gt; 5   -4.6 0.00995
#&gt; 6   -4.5 0.01099
#&gt; 7   -4.4 0.01213
#&gt; 8   -4.3 0.01339
#&gt; 9   -4.2 0.01477
#&gt; 10  -4.1 0.01630
#&gt; 11  -4.0 0.01799
#&gt; 12  -3.9 0.01984
#&gt; 13  -3.8 0.02188
#&gt; 14  -3.7 0.02413
#&gt; 15  -3.6 0.02660
#&gt; 16  -3.5 0.02931
#&gt; 17  -3.4 0.03230
#&gt; 18  -3.3 0.03557
#&gt; 19  -3.2 0.03917
#&gt; 20  -3.1 0.04311
#&gt; 21  -3.0 0.04743
#&gt; 22  -2.9 0.05215
#&gt; 23  -2.8 0.05732
#&gt; 24  -2.7 0.06297
#&gt; 25  -2.6 0.06914
#&gt; 26  -2.5 0.07586
#&gt; 27  -2.4 0.08317
#&gt; 28  -2.3 0.09112
#&gt; 29  -2.2 0.09975
#&gt; 30  -2.1 0.10910
#&gt; 31  -2.0 0.11920
#&gt; 32  -1.9 0.13011
#&gt; 33  -1.8 0.14185
#&gt; 34  -1.7 0.15447
#&gt; 35  -1.6 0.16798
#&gt; 36  -1.5 0.18243
#&gt; 37  -1.4 0.19782
#&gt; 38  -1.3 0.21417
#&gt; 39  -1.2 0.23148
#&gt; 40  -1.1 0.24974
#&gt; 41  -1.0 0.26894
#&gt; 42  -0.9 0.28905
#&gt; 43  -0.8 0.31003
#&gt; 44  -0.7 0.33181
#&gt; 45  -0.6 0.35434
#&gt; 46  -0.5 0.37754
#&gt; 47  -0.4 0.40131
#&gt; 48  -0.3 0.42556
#&gt; 49  -0.2 0.45017
#&gt; 50  -0.1 0.47502
#&gt; 51   0.0 0.50000
#&gt; 52   0.1 0.52498
#&gt; 53   0.2 0.54983
#&gt; 54   0.3 0.57444
#&gt; 55   0.4 0.59869
#&gt; 56   0.5 0.62246
#&gt; 57   0.6 0.64566
#&gt; 58   0.7 0.66819
#&gt; 59   0.8 0.68997
#&gt; 60   0.9 0.71095
#&gt; 61   1.0 0.73106
#&gt; 62   1.1 0.75026
#&gt; 63   1.2 0.76852
#&gt; 64   1.3 0.78584
#&gt; 65   1.4 0.80218
#&gt; 66   1.5 0.81757
#&gt; 67   1.6 0.83202
#&gt; 68   1.7 0.84553
#&gt; 69   1.8 0.85815
#&gt; 70   1.9 0.86989
#&gt; 71   2.0 0.88080
#&gt; 72   2.1 0.89090
#&gt; 73   2.2 0.90025
#&gt; 74   2.3 0.90888
#&gt; 75   2.4 0.91683
#&gt; 76   2.5 0.92414
#&gt; 77   2.6 0.93086
#&gt; 78   2.7 0.93703
#&gt; 79   2.8 0.94268
#&gt; 80   2.9 0.94785
#&gt; 81   3.0 0.95257
#&gt; 82   3.1 0.95689
#&gt; 83   3.2 0.96083
#&gt; 84   3.3 0.96443
#&gt; 85   3.4 0.96770
#&gt; 86   3.5 0.97069
#&gt; 87   3.6 0.97340
#&gt; 88   3.7 0.97587
#&gt; 89   3.8 0.97812
#&gt; 90   3.9 0.98016
#&gt; 91   4.0 0.98201
#&gt; 92   4.1 0.98370
#&gt; 93   4.2 0.98523
#&gt; 94   4.3 0.98661
#&gt; 95   4.4 0.98787
#&gt; 96   4.5 0.98901
#&gt; 97   4.6 0.99005
#&gt; 98   4.7 0.99099
#&gt; 99   4.8 0.99184
#&gt; 100  4.9 0.99261
#&gt; 101  5.0 0.99331</code></pre>
<div class="inline-figure"><img src="9992-appendixB_files/figure-html/sigmoid-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Plot the sigmoid function using an R custom-made function:</p>
<div class="sourceCode" id="cb591"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sigmoid</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
   <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">sigmoid</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">'blue'</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, main <span class="op">=</span> <span class="st">"Sigmoid"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="9992-appendixB_files/figure-html/unnamed-chunk-2-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="relu" class="section level2" number="17.2">
<h2>
<span class="header-section-number">B.2</span> ReLU<a class="anchor" aria-label="anchor" href="#relu"><i class="fas fa-link"></i></a>
</h2>
<p>Using the PyTorch <code>relu()</code> function:</p>
<div class="sourceCode" id="cb592"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">range</span><span class="op">(</span><span class="op">-</span><span class="fl">5.</span>, <span class="fl">5.</span>, <span class="fl">0.1</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">relu</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span>, sx <span class="op">=</span> <span class="va">y</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">sx</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"ReLU"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="9992-appendixB_files/figure-html/relu-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="tanh" class="section level2" number="17.3">
<h2>
<span class="header-section-number">B.3</span> tanh<a class="anchor" aria-label="anchor" href="#tanh"><i class="fas fa-link"></i></a>
</h2>
<p>Using the PyTorch <code><a href="https://rdrr.io/r/base/Hyperbolic.html">tanh()</a></code> function:</p>
<div class="sourceCode" id="cb593"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">range</span><span class="op">(</span><span class="op">-</span><span class="fl">5.</span>, <span class="fl">5.</span>, <span class="fl">0.1</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">tanh</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span>, sx <span class="op">=</span> <span class="va">y</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">sx</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"tanh"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="9992-appendixB_files/figure-html/tanh-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="softmax" class="section level2" number="17.4">
<h2>
<span class="header-section-number">B.4</span> Softmax<a class="anchor" aria-label="anchor" href="#softmax"><i class="fas fa-link"></i></a>
</h2>
<p>Using the PyTorch <code>softmax()</code> function:</p>
<div class="sourceCode" id="cb594"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">range</span><span class="op">(</span><span class="op">-</span><span class="fl">5.0</span>, <span class="fl">5.0</span>, <span class="fl">0.1</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">torch</span><span class="op">$</span><span class="fu">softmax</span><span class="op">(</span><span class="va">x</span>, dim<span class="op">=</span><span class="fl">0L</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span>, sx <span class="op">=</span> <span class="va">y</span><span class="op">$</span><span class="fu">numpy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">sx</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Softmax"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="9992-appendixB_files/figure-html/softmax-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="activation-functions-in-python" class="section level2" number="17.5">
<h2>
<span class="header-section-number">B.5</span> Activation functions in Python<a class="anchor" aria-label="anchor" href="#activation-functions-in-python"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb595"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/f0nzie/rTorch">rTorch</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb596"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb596-1"><a href="appendixB.html#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb596-2"><a href="appendixB.html#cb596-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb596-3"><a href="appendixB.html#cb596-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span></code></pre></div>
<div id="linear-activation" class="section level3 unnumbered">
<h3>Linear activation<a class="anchor" aria-label="anchor" href="#linear-activation"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb597"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb597-1"><a href="appendixB.html#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Linear(x, derivative<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb597-2"><a href="appendixB.html#cb597-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb597-3"><a href="appendixB.html#cb597-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Computes the Linear activation function for array x</span></span>
<span id="cb597-4"><a href="appendixB.html#cb597-4" aria-hidden="true" tabindex="-1"></a><span class="co">    inputs:</span></span>
<span id="cb597-5"><a href="appendixB.html#cb597-5" aria-hidden="true" tabindex="-1"></a><span class="co">    x: array</span></span>
<span id="cb597-6"><a href="appendixB.html#cb597-6" aria-hidden="true" tabindex="-1"></a><span class="co">    derivative: if True, return the derivative else the forward pass</span></span>
<span id="cb597-7"><a href="appendixB.html#cb597-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb597-8"><a href="appendixB.html#cb597-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb597-9"><a href="appendixB.html#cb597-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> derivative:              <span class="co"># Return derivative of the function at x</span></span>
<span id="cb597-10"><a href="appendixB.html#cb597-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.ones_like(x)</span>
<span id="cb597-11"><a href="appendixB.html#cb597-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:                       <span class="co"># Return forward pass of the function at x</span></span>
<span id="cb597-12"><a href="appendixB.html#cb597-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span></code></pre></div>
</div>
<div id="sigmoid-activation" class="section level3 unnumbered">
<h3>Sigmoid activation<a class="anchor" aria-label="anchor" href="#sigmoid-activation"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb598"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb598-1"><a href="appendixB.html#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Sigmoid(x, derivative<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb598-2"><a href="appendixB.html#cb598-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb598-3"><a href="appendixB.html#cb598-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Computes the Sigmoid activation function for array x</span></span>
<span id="cb598-4"><a href="appendixB.html#cb598-4" aria-hidden="true" tabindex="-1"></a><span class="co">    inputs:</span></span>
<span id="cb598-5"><a href="appendixB.html#cb598-5" aria-hidden="true" tabindex="-1"></a><span class="co">    x: array </span></span>
<span id="cb598-6"><a href="appendixB.html#cb598-6" aria-hidden="true" tabindex="-1"></a><span class="co">    derivative: if True, return the derivative else the forward pass</span></span>
<span id="cb598-7"><a href="appendixB.html#cb598-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb598-8"><a href="appendixB.html#cb598-8" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>np.exp(<span class="op">-</span>x))</span>
<span id="cb598-9"><a href="appendixB.html#cb598-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb598-10"><a href="appendixB.html#cb598-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> derivative:              <span class="co"># Return derivative of the function at x</span></span>
<span id="cb598-11"><a href="appendixB.html#cb598-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> f<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>f)</span>
<span id="cb598-12"><a href="appendixB.html#cb598-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:                       <span class="co"># Return forward pass of the function at x</span></span>
<span id="cb598-13"><a href="appendixB.html#cb598-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> f</span></code></pre></div>
</div>
<div id="hyperbolic-tangent-activation" class="section level3 unnumbered">
<h3>Hyperbolic Tangent activation<a class="anchor" aria-label="anchor" href="#hyperbolic-tangent-activation"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb599"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb599-1"><a href="appendixB.html#cb599-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Tanh(x, derivative<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb599-2"><a href="appendixB.html#cb599-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb599-3"><a href="appendixB.html#cb599-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Computes the Hyperbolic Tangent activation function for array x</span></span>
<span id="cb599-4"><a href="appendixB.html#cb599-4" aria-hidden="true" tabindex="-1"></a><span class="co">    inputs:</span></span>
<span id="cb599-5"><a href="appendixB.html#cb599-5" aria-hidden="true" tabindex="-1"></a><span class="co">    x: array </span></span>
<span id="cb599-6"><a href="appendixB.html#cb599-6" aria-hidden="true" tabindex="-1"></a><span class="co">    derivative: if True, return the derivative else the forward pass</span></span>
<span id="cb599-7"><a href="appendixB.html#cb599-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb599-8"><a href="appendixB.html#cb599-8" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> (np.exp(x)<span class="op">-</span>np.exp(<span class="op">-</span>x))<span class="op">/</span>(np.exp(x)<span class="op">+</span>np.exp(<span class="op">-</span>x))</span>
<span id="cb599-9"><a href="appendixB.html#cb599-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb599-10"><a href="appendixB.html#cb599-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> derivative:              <span class="co"># Return  derivative of the function at x</span></span>
<span id="cb599-11"><a href="appendixB.html#cb599-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span><span class="op">-</span>f<span class="op">**</span><span class="dv">2</span></span>
<span id="cb599-12"><a href="appendixB.html#cb599-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:                       <span class="co"># Return the forward pass of the function at x</span></span>
<span id="cb599-13"><a href="appendixB.html#cb599-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> f</span></code></pre></div>
</div>
<div id="rectifier-linear-unit-relu" class="section level3 unnumbered">
<h3>Rectifier linear unit (ReLU)<a class="anchor" aria-label="anchor" href="#rectifier-linear-unit-relu"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb600"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb600-1"><a href="appendixB.html#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ReLU(x, derivative<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb600-2"><a href="appendixB.html#cb600-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb600-3"><a href="appendixB.html#cb600-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Computes the Rectifier Linear Unit activation function for array x</span></span>
<span id="cb600-4"><a href="appendixB.html#cb600-4" aria-hidden="true" tabindex="-1"></a><span class="co">    inputs:</span></span>
<span id="cb600-5"><a href="appendixB.html#cb600-5" aria-hidden="true" tabindex="-1"></a><span class="co">    x: array</span></span>
<span id="cb600-6"><a href="appendixB.html#cb600-6" aria-hidden="true" tabindex="-1"></a><span class="co">    derivative: if True, return the derivative else the forward pass</span></span>
<span id="cb600-7"><a href="appendixB.html#cb600-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb600-8"><a href="appendixB.html#cb600-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb600-9"><a href="appendixB.html#cb600-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> derivative:              <span class="co"># Return derivative of the function at x</span></span>
<span id="cb600-10"><a href="appendixB.html#cb600-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (x<span class="op">&gt;</span><span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb600-11"><a href="appendixB.html#cb600-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:                       <span class="co"># Return forward pass of the function at x</span></span>
<span id="cb600-12"><a href="appendixB.html#cb600-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.maximum(x, <span class="dv">0</span>)</span></code></pre></div>
</div>
<div id="visualization-with-matplotlib" class="section level3 unnumbered">
<h3>Visualization with <code>matplotlib</code><a class="anchor" aria-label="anchor" href="#visualization-with-matplotlib"><i class="fas fa-link"></i></a>
</h3>
<p>Plotting using <code>matplotlib</code>:</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb601-1"><a href="appendixB.html#cb601-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">100</span>)</span>
<span id="cb601-2"><a href="appendixB.html#cb601-2" aria-hidden="true" tabindex="-1"></a>units <span class="op">=</span> {</span>
<span id="cb601-3"><a href="appendixB.html#cb601-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Linear"</span>: <span class="kw">lambda</span> x: Linear(x),</span>
<span id="cb601-4"><a href="appendixB.html#cb601-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sigmoid"</span>: <span class="kw">lambda</span> x: Sigmoid(x),</span>
<span id="cb601-5"><a href="appendixB.html#cb601-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ReLU"</span>: <span class="kw">lambda</span> x: ReLU(x),</span>
<span id="cb601-6"><a href="appendixB.html#cb601-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tanh"</span>: <span class="kw">lambda</span> x: Tanh(x)</span>
<span id="cb601-7"><a href="appendixB.html#cb601-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb601-8"><a href="appendixB.html#cb601-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb601-9"><a href="appendixB.html#cb601-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb601-10"><a href="appendixB.html#cb601-10" aria-hidden="true" tabindex="-1"></a>[plt.plot(x, unit(x), label<span class="op">=</span>unit_name, lw<span class="op">=</span><span class="dv">2</span>) </span>
<span id="cb601-11"><a href="appendixB.html#cb601-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> unit_name, unit <span class="kw">in</span> units.items()]</span></code></pre></div>
<div class="sourceCode" id="cb602"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb602-1"><a href="appendixB.html#cb602-1" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">2</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb602-2"><a href="appendixB.html#cb602-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Activation functions'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb602-3"><a href="appendixB.html#cb602-3" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="op">-</span><span class="dv">2</span>, <span class="dv">5</span>])</span></code></pre></div>
<div class="sourceCode" id="cb603"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb603-1"><a href="appendixB.html#cb603-1" aria-hidden="true" tabindex="-1"></a>plt.xlim([<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>])</span></code></pre></div>
<div class="sourceCode" id="cb604"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb604-1"><a href="appendixB.html#cb604-1" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="inline-figure"><img src="9992-appendixB_files/figure-html/unnamed-chunk-9-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="softmax-code-in-python" class="section level2" number="17.6">
<h2>
<span class="header-section-number">B.6</span> Softmax code in Python<a class="anchor" aria-label="anchor" href="#softmax-code-in-python"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb605"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb605-1"><a href="appendixB.html#cb605-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Source: https://dataaspirant.com/2017/03/07/difference-between-softmax-function-and-sigmoid-function/</span></span>
<span id="cb605-2"><a href="appendixB.html#cb605-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb605-3"><a href="appendixB.html#cb605-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb605-4"><a href="appendixB.html#cb605-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb605-5"><a href="appendixB.html#cb605-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb605-6"><a href="appendixB.html#cb605-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> softmax(inputs):</span>
<span id="cb605-7"><a href="appendixB.html#cb605-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb605-8"><a href="appendixB.html#cb605-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Calculate the softmax for the give inputs (array)</span></span>
<span id="cb605-9"><a href="appendixB.html#cb605-9" aria-hidden="true" tabindex="-1"></a><span class="co">    :param inputs:</span></span>
<span id="cb605-10"><a href="appendixB.html#cb605-10" aria-hidden="true" tabindex="-1"></a><span class="co">    :return:</span></span>
<span id="cb605-11"><a href="appendixB.html#cb605-11" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb605-12"><a href="appendixB.html#cb605-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.exp(inputs) <span class="op">/</span> <span class="bu">float</span>(<span class="bu">sum</span>(np.exp(inputs)))</span>
<span id="cb605-13"><a href="appendixB.html#cb605-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb605-14"><a href="appendixB.html#cb605-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb605-15"><a href="appendixB.html#cb605-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> line_graph(x, y, x_title, y_title):</span>
<span id="cb605-16"><a href="appendixB.html#cb605-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb605-17"><a href="appendixB.html#cb605-17" aria-hidden="true" tabindex="-1"></a><span class="co">    Draw line graph with x and y values</span></span>
<span id="cb605-18"><a href="appendixB.html#cb605-18" aria-hidden="true" tabindex="-1"></a><span class="co">    :param x:</span></span>
<span id="cb605-19"><a href="appendixB.html#cb605-19" aria-hidden="true" tabindex="-1"></a><span class="co">    :param y:</span></span>
<span id="cb605-20"><a href="appendixB.html#cb605-20" aria-hidden="true" tabindex="-1"></a><span class="co">    :param x_title:</span></span>
<span id="cb605-21"><a href="appendixB.html#cb605-21" aria-hidden="true" tabindex="-1"></a><span class="co">    :param y_title:</span></span>
<span id="cb605-22"><a href="appendixB.html#cb605-22" aria-hidden="true" tabindex="-1"></a><span class="co">    :return:</span></span>
<span id="cb605-23"><a href="appendixB.html#cb605-23" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb605-24"><a href="appendixB.html#cb605-24" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, y)</span>
<span id="cb605-25"><a href="appendixB.html#cb605-25" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(x_title)</span>
<span id="cb605-26"><a href="appendixB.html#cb605-26" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(y_title)</span>
<span id="cb605-27"><a href="appendixB.html#cb605-27" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb605-28"><a href="appendixB.html#cb605-28" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb605-29"><a href="appendixB.html#cb605-29" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb605-30"><a href="appendixB.html#cb605-30" aria-hidden="true" tabindex="-1"></a>graph_x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">100</span>)</span>
<span id="cb605-31"><a href="appendixB.html#cb605-31" aria-hidden="true" tabindex="-1"></a>graph_y <span class="op">=</span> softmax(graph_x)</span>
<span id="cb605-32"><a href="appendixB.html#cb605-32" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb605-33"><a href="appendixB.html#cb605-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Graph X readings: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(graph_x))</span></code></pre></div>
<div class="sourceCode" id="cb606"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb606-1"><a href="appendixB.html#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Graph Y readings: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(graph_y))</span>
<span id="cb606-2"><a href="appendixB.html#cb606-2" aria-hidden="true" tabindex="-1"></a> </span></code></pre></div>
<div class="sourceCode" id="cb607"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb607-1"><a href="appendixB.html#cb607-1" aria-hidden="true" tabindex="-1"></a>line_graph(graph_x, graph_y, <span class="st">"Inputs"</span>, <span class="st">"Softmax Scores"</span>)</span></code></pre></div>
<div class="inline-figure"><img src="9992-appendixB_files/figure-html/unnamed-chunk-10-1.png" width="70%" style="display: block; margin: auto;"></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="appendixA.html"><span class="header-section-number">A</span> Statistical Background</a></div>
<div class="next"><a href="references.html">References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#appendixB"><span class="header-section-number">B</span> Activation Functions</a></li>
<li><a class="nav-link" href="#sigmoid"><span class="header-section-number">B.1</span> Sigmoid</a></li>
<li><a class="nav-link" href="#relu"><span class="header-section-number">B.2</span> ReLU</a></li>
<li><a class="nav-link" href="#tanh"><span class="header-section-number">B.3</span> tanh</a></li>
<li><a class="nav-link" href="#softmax"><span class="header-section-number">B.4</span> Softmax</a></li>
<li>
<a class="nav-link" href="#activation-functions-in-python"><span class="header-section-number">B.5</span> Activation functions in Python</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#linear-activation">Linear activation</a></li>
<li><a class="nav-link" href="#sigmoid-activation">Sigmoid activation</a></li>
<li><a class="nav-link" href="#hyperbolic-tangent-activation">Hyperbolic Tangent activation</a></li>
<li><a class="nav-link" href="#rectifier-linear-unit-relu">Rectifier linear unit (ReLU)</a></li>
<li><a class="nav-link" href="#visualization-with-matplotlib">Visualization with matplotlib</a></li>
</ul>
</li>
<li><a class="nav-link" href="#softmax-code-in-python"><span class="header-section-number">B.6</span> Softmax code in Python</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/f0nzie/rtorch-minimal-book/blob/master/9992-appendixB.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/f0nzie/rtorch-minimal-book/edit/master/9992-appendixB.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Minimal rTorch Book</strong>" was written by Alfonso R. Reyes. It was last built on 2020-11-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>

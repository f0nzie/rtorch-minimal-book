<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 1 Introduction | A Minimal rTorch Book</title>
<meta name="author" content="Alfonso R. Reyes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.5.3/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.16/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Minimal rTorch Book</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prerequisites</a></li>
<li class="book-part">Getting Started</li>
<li><a class="active" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="pytorch-and-numpy.html"><span class="header-section-number">2</span> PyTorch and NumPy</a></li>
<li><a class="" href="rtorch-vs-pytorch.html"><span class="header-section-number">3</span> rTorch vs PyTorch</a></li>
<li><a class="" href="converting-tensors.html"><span class="header-section-number">4</span> Converting tensors</a></li>
<li class="book-part">Basic Tensor Operations</li>
<li><a class="" href="tensors.html"><span class="header-section-number">5</span> Tensors</a></li>
<li><a class="" href="linearalgebra.html"><span class="header-section-number">6</span> Linear Algebra with Torch</a></li>
<li><a class="" href="creating-pytorch-classes.html"><span class="header-section-number">7</span> Creating PyTorch classes</a></li>
<li class="book-part">Logistic Regression</li>
<li><a class="" href="example-1-a-classification-problem.html"><span class="header-section-number">8</span> Example 1: A classification problem</a></li>
<li><a class="" href="mnistdigits.html"><span class="header-section-number">9</span> Example 2: MNIST handwritten digits</a></li>
<li class="book-part">Linear Regression</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">10</span> Linear Regression</a></li>
<li><a class="" href="linear-regression-1.html"><span class="header-section-number">11</span> Linear Regression</a></li>
<li class="book-part">Neural Networks</li>
<li><a class="" href="neural-networks.html"><span class="header-section-number">12</span> Neural Networks</a></li>
<li><a class="" href="a-neural-network-step-by-step.html"><span class="header-section-number">13</span> A neural network step-by-step</a></li>
<li class="book-part">PyTorch and R data structures</li>
<li><a class="" href="working-with-a-dataframe.html"><span class="header-section-number">14</span> Working with a data●frame</a></li>
<li><a class="" href="working-with-datatable.html"><span class="header-section-number">15</span> Working with data●table</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="appendixA.html"><span class="header-section-number">A</span> Statistical Background</a></li>
<li><a class="" href="appendixB.html"><span class="header-section-number">B</span> Activation Functions</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/f0nzie/rtorch-minimal-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="intro" class="section level1" number="1">
<h1>
<span class="header-section-number">1</span> Introduction<a class="anchor" aria-label="anchor" href="#intro"><i class="fas fa-link"></i></a>
</h1>
<p><em>Last update: Sun Oct 25 13:00:41 2020 -0500 (265c0b3c1)</em></p>
<div id="motivation" class="section level2" number="1.1">
<h2>
<span class="header-section-number">1.1</span> Motivation<a class="anchor" aria-label="anchor" href="#motivation"><i class="fas fa-link"></i></a>
</h2>
<p><em>Why do we want a package of something that is already working well, such as PyTorch?</em></p>
<p>There are several reasons, but the main one is to bring another machine learning framework to R. Probably, it is just me but I feel <em>PyTorch</em> very comfortable to work with. Feels pretty much like everything else in Python. Very <strong>pythonic</strong>. I have tried other frameworks in R. The closest that matches a natural language like PyTorch, is <a href="https://mxnet.apache.org/versions/1.7.0/get_started?">MXnet</a>. Unfortunately, <em>MXnet</em> it is the hardest to install and maintain after updates.</p>
<p>Yes. I could have worked directly with <em>PyTorch</em> in a native Python environment, such as <em>Jupyter,</em> or <em>PyCharm,</em> or <a href="https://code.visualstudio.com/docs/python/jupyter-support">vscode</a> notebooks but it very hard to quit <strong>RMarkdown</strong> once you get used to it. It is the real thing in regards to <a href="https://en.wikipedia.org/wiki/Literate_programming">literate programming</a> and <strong>reproducibility</strong>. It does not only contribute to improving the quality of the code but establishes a workflow for a better understanding of a subject by your intended readers <span class="citation">(<a href="references.html#ref-knuth1983" role="doc-biblioref">Knuth 1983</a>)</span>, in what is been called the <em>literate programming paradigm</em> <span class="citation">(<a href="references.html#ref-cordes1991" role="doc-biblioref">Cordes and Brown 1991</a>)</span>.</p>
<p>This has the additional benefit of giving the ability to write combination of <em>Python</em> and <em>R</em> code together in the same document. There will be times when it is better to create a class in <em>Python</em>; and other times where <em>R</em> will be more convenient to handle a data structure. I show some examples using <code>data.frame</code> and <code>data.table</code> along with <em>PyTorch</em> tensors.</p>
</div>
<div id="start-using-rtorch" class="section level2" number="1.2">
<h2>
<span class="header-section-number">1.2</span> Start using <code>rTorch</code><a class="anchor" aria-label="anchor" href="#start-using-rtorch"><i class="fas fa-link"></i></a>
</h2>
<p>Start using <code>rTorch</code> is very simple. After installing the minimum system requirements -such as <em>conda</em> -, you just call it with:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/f0nzie/rTorch">rTorch</a></span><span class="op">)</span></code></pre></div>
<p>There are several ways of testing if <code>rTorch</code> is up and running. Let’s see some of them:</p>
<div id="get-the-pytorch-version" class="section level3" number="1.2.1">
<h3>
<span class="header-section-number">1.2.1</span> Get the PyTorch version<a class="anchor" aria-label="anchor" href="#get-the-pytorch-version"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rTorch</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rTorch/man/torch_config.html">torch_version</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; [1] "1.6"</code></pre>
</div>
<div id="pytorch-configuration" class="section level3" number="1.2.2">
<h3>
<span class="header-section-number">1.2.2</span> PyTorch configuration<a class="anchor" aria-label="anchor" href="#pytorch-configuration"><i class="fas fa-link"></i></a>
</h3>
<p>This will show the PyTorch version and the current version of Python installed, as well as the paths to folders where they reside.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rTorch</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rTorch/man/torch_config.html">torch_config</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; PyTorch v1.6.0 (~/miniconda3/envs/r-torch/lib/python3.7/site-packages/torch)
#&gt; Python v3.7 (~/miniconda3/envs/r-torch/bin/python)
#&gt; NumPy v1.19.4)</code></pre>
<hr>
</div>
</div>
<div id="what-can-you-do-with-rtorch" class="section level2" number="1.3">
<h2>
<span class="header-section-number">1.3</span> What can you do with <code>rTorch</code><a class="anchor" aria-label="anchor" href="#what-can-you-do-with-rtorch"><i class="fas fa-link"></i></a>
</h2>
<p>Practically, you can do everything you could with <strong>PyTorch</strong> within the <strong>R</strong> ecosystem. Additionally to the <code>rTorch</code> module, from where you can extract methods, functions and classes, there are available two more modules: <code>torchvision</code> and <code>np</code>, which is short for <code>numpy</code>. We could use the modules with:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rTorch</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/rTorch/man/modules.html">torchvision</a></span>
<span class="fu">rTorch</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/rTorch/man/modules.html">np</a></span>
<span class="fu">rTorch</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/rTorch/man/modules.html">torch</a></span></code></pre></div>
<pre><code>#&gt; Module(torchvision)
#&gt; Module(numpy)
#&gt; Module(torch)</code></pre>
</div>
<div id="getting-help" class="section level2" number="1.4">
<h2>
<span class="header-section-number">1.4</span> Getting help<a class="anchor" aria-label="anchor" href="#getting-help"><i class="fas fa-link"></i></a>
</h2>
<p>We get a glimpse of the first lines of the <code><a href="https://rdrr.io/pkg/rTorch/man/modules.html">help("torch")</a></code> via a Python chunk:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="intro.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(<span class="st">"torch"</span>)</span></code></pre></div>
<pre><code>...
#&gt; NAME
#&gt;     torch
#&gt; 
#&gt; DESCRIPTION
#&gt;     The torch package contains data structures for multi-dimensional
#&gt;     tensors and mathematical operations over these are defined.
#&gt;     Additionally, it provides many utilities for efficient serializing of
#&gt;     Tensors and arbitrary types, and other useful utilities.
...</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="intro.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(<span class="st">"torch.tensor"</span>)</span></code></pre></div>
<pre><code>...
#&gt; Help on built-in function tensor in torch:
#&gt; 
#&gt; torch.tensor = tensor(...)
#&gt;     tensor(data, dtype=None, device=None, requires_grad=False, pin_memory=False) -&gt; Tensor
#&gt;     
#&gt;     Constructs a tensor with :attr:`data`.
#&gt;     
#&gt;     .. warning::
#&gt;     
#&gt;         :func:`torch.tensor` always copies :attr:`data`. If you have a Tensor
#&gt;         ``data`` and want to avoid a copy, use :func:`torch.Tensor.requires_grad_`
#&gt;         or :func:`torch.Tensor.detach`.
#&gt;         If you have a NumPy ``ndarray`` and want to avoid a copy, use
#&gt;         :func:`torch.as_tensor`.
#&gt;     
#&gt;     .. warning::
#&gt;     
#&gt;         When data is a tensor `x`, :func:`torch.tensor` reads out 'the data' from whatever it is passed,
#&gt;         and constructs a leaf variable. Therefore ``torch.tensor(x)`` is equivalent to ``x.clone().detach()``
#&gt;         and ``torch.tensor(x, requires_grad=True)`` is equivalent to ``x.clone().detach().requires_grad_(True)``.
...</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="intro.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(<span class="st">"torch.cat"</span>)</span></code></pre></div>
<pre><code>...
#&gt; Help on built-in function cat in torch:
#&gt; 
#&gt; torch.cat = cat(...)
#&gt;     cat(tensors, dim=0, out=None) -&gt; Tensor
#&gt;     
#&gt;     Concatenates the given sequence of :attr:`seq` tensors in the given dimension.
#&gt;     All tensors must either have the same shape (except in the concatenating
#&gt;     dimension) or be empty.
#&gt;     
#&gt;     :func:`torch.cat` can be seen as an inverse operation for :func:`torch.split`
#&gt;     and :func:`torch.chunk`.
#&gt;     
#&gt;     :func:`torch.cat` can be best understood via examples.
#&gt;     
#&gt;     Args:
#&gt;         tensors (sequence of Tensors): any python sequence of tensors of the same type.
#&gt;             Non-empty tensors provided must have the same shape, except in the
#&gt;             cat dimension.
#&gt;         dim (int, optional): the dimension over which the tensors are concatenated
#&gt;         out (Tensor, optional): the output tensor.
...</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="intro.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(<span class="st">"numpy.arange"</span>)</span></code></pre></div>
<pre><code>...
#&gt; Help on built-in function arange in numpy:
#&gt; 
#&gt; numpy.arange = arange(...)
#&gt;     arange([start,] stop[, step,], dtype=None)
#&gt;     
#&gt;     Return evenly spaced values within a given interval.
#&gt;     
#&gt;     Values are generated within the half-open interval ``[start, stop)``
#&gt;     (in other words, the interval including `start` but excluding `stop`).
#&gt;     For integer arguments the function is equivalent to the Python built-in
#&gt;     `range` function, but returns an ndarray rather than a list.
#&gt;     
#&gt;     When using a non-integer step, such as 0.1, the results will often not
#&gt;     be consistent.  It is better to use `numpy.linspace` for these cases.
#&gt;     
#&gt;     Parameters
#&gt;     ----------
#&gt;     start : number, optional
#&gt;         Start of interval.  The interval includes this value.  The default
#&gt;         start value is 0.
#&gt;     stop : number
#&gt;         End of interval.  The interval does not include this value, except
#&gt;         in some cases where `step` is not an integer and floating point
#&gt;         round-off affects the length of `out`.
#&gt;     step : number, optional
...</code></pre>
<p>Finally, these are the classes for the module <code>torchvision.datasets</code>. We are using Python to list them using the <code>help</code> function.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="intro.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(<span class="st">"torchvision.datasets"</span>)</span></code></pre></div>
<pre><code>...
#&gt; Help on package torchvision.datasets in torchvision:
#&gt; 
#&gt; NAME
#&gt;     torchvision.datasets
#&gt; 
#&gt; PACKAGE CONTENTS
#&gt;     caltech
#&gt;     celeba
#&gt;     cifar
#&gt;     cityscapes
#&gt;     coco
#&gt;     fakedata
#&gt;     flickr
#&gt;     folder
#&gt;     hmdb51
#&gt;     imagenet
#&gt;     kinetics
#&gt;     lsun
#&gt;     mnist
#&gt;     omniglot
#&gt;     phototour
#&gt;     samplers (package)
#&gt;     sbd
#&gt;     sbu
#&gt;     semeion
#&gt;     stl10
#&gt;     svhn
#&gt;     ucf101
#&gt;     usps
#&gt;     utils
#&gt;     video_utils
#&gt;     vision
#&gt;     voc
#&gt; 
#&gt; CLASSES
...</code></pre>
<p>In other words, all the functions, modules, classes in PyTorch are available to rTorch.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="index.html">Prerequisites</a></div>
<div class="next"><a href="pytorch-and-numpy.html"><span class="header-section-number">2</span> PyTorch and NumPy</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#intro"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="nav-link" href="#motivation"><span class="header-section-number">1.1</span> Motivation</a></li>
<li>
<a class="nav-link" href="#start-using-rtorch"><span class="header-section-number">1.2</span> Start using rTorch</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#get-the-pytorch-version"><span class="header-section-number">1.2.1</span> Get the PyTorch version</a></li>
<li><a class="nav-link" href="#pytorch-configuration"><span class="header-section-number">1.2.2</span> PyTorch configuration</a></li>
</ul>
</li>
<li><a class="nav-link" href="#what-can-you-do-with-rtorch"><span class="header-section-number">1.3</span> What can you do with rTorch</a></li>
<li><a class="nav-link" href="#getting-help"><span class="header-section-number">1.4</span> Getting help</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/f0nzie/rtorch-minimal-book/blob/master/0101-intro.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/f0nzie/rtorch-minimal-book/edit/master/0101-intro.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Minimal rTorch Book</strong>" was written by Alfonso R. Reyes. It was last built on 2020-11-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
